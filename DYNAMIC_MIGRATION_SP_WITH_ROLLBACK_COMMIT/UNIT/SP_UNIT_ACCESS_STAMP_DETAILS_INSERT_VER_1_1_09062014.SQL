--version:1.1 --sdate:09/06/2014 --edate:09/06/2014 --desc:IMPLEMENTING ROLLBACK AND COMMIT --done by:BHAVANI.R --issue:566
-- version:1.0 -- sadte:21/03/2014 -- edate:21/03/2014 -- issue:765 -- commentno:8 -- desc:dynamically get source nd destination schema -- doneby:RL
--  version:0.9 --  sdate:17/03/2014 --  edate:17/03/2014 --  issue:765 -- desc:droped temp table -- doneby:RL
-- version:0.8 -- sdate:14/03/2014 -- edate:14/03/2014 -- issue:750 -- desc:added comments in unit_access_stamp_details -- doneby:RL
-- version:0.7 -- sdate:26/02/2014 -- edate:26/02/2014 -- issue:750 -- desc:uld_id datatype intger changed as integer(2) -- doneby:RL
DROP PROCEDURE IF EXISTS SP_UNIT_ACCESS_STAMP_DETAILS_INSERT;
CREATE PROCEDURE SP_UNIT_ACCESS_STAMP_DETAILS_INSERT(IN DESTINATIONSCHEMA VARCHAR(50))
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN 
ROLLBACK;
END;
START TRANSACTION;

		SET @INSERTUASDQUERY = (SELECT CONCAT('INSERT INTO ',DESTINATIONSCHEMA,'.UNIT_ACCESS_STAMP_DETAILS
		(UNIT_ID,USDT_ID,UASD_STAMPDUTYDATE,UASD_STAMPDUTYAMT,
        UASD_ACCESS_CARD,UASD_ACCESS_ACTIVE,UASD_ACCESS_INVENTORY,UASD_ACCESS_LOST,URTD_ID,UASD_COMMENTS,ULD_ID,UASD_TIMESTAMP)
		SELECT UNIT_ID,USDT_ID,UASD_STAMPDUTYDATE,UASD_STAMPDUTYAMT,
        UASD_ACCESS_CARD,UASD_ACCESS_ACTIVE,UASD_ACCESS_INVENTORY,UASD_ACCESS_LOST,URTD_ID,UASD_COMMENTS,ULD_ID,UASD_TIMESTAMP
		FROM ',DESTINATIONSCHEMA,'.TEMP_UNIT_ACCESS_STAMP_DETAILS'));
		PREPARE INSERTUASDQUERYSTMT FROM @INSERTUASDQUERY;
		EXECUTE INSERTUASDQUERYSTMT;
COMMIT;
END;