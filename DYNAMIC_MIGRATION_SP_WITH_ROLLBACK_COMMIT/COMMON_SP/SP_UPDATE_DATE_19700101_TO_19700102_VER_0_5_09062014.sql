-- version:0.5 --sadte:09/06/2014 --edate:09/06/2014 --issue:566 COMMNT:12--desc:IMPLEMENTED ROLL BACK AND COMMIT --done by:DHIVYA
-- version:0.4 --sadte:11/04/2014 --edate:11/04/2014 --issue:803 --desc:added call query --done by:RL
--version:0.3 --sdate:04/04/2014 --edate;04/04/2014 --issue:797 --comment no#4 --desc: Changing CUSTOMER_TERMINATION_DETAILS AS CUSTOMER_LP_DETAILS --doneby:BHAVANI.R
--version:0.2 --sdate:29/03/2014 --edate;29/03/2014 --issue:747 --comment no#42 --desc: changed get source to destination dynamically --doneby:RL
--version:0.1 --sdate:01/02/2014 --edate:01/02/2014 --issue:594 --comment:69 --doneby:RL

DROP PROCEDURE IF EXISTS SP_UPDATE_DATE_19700101_TO_19700102;
CREATE PROCEDURE SP_UPDATE_DATE_19700101_TO_19700102(IN DESTINATIONSCHEMA VARCHAR(50))
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN
ROLLBACK;
END;
START TRANSACTION;
	
	SET @SDATE = '1970-01-01';
	SET @EDATE = '1970-01-02';

--UPDATE QUERY FOR UNIT_DETAILS TABLE
	SET @UPDATE_UNIT_SDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.UNIT_DETAILS SET UD_START_DATE = @EDATE WHERE UD_START_DATE = @SDATE'));
	PREPARE UPDATE_UNIT_SDATE_STMT FROM @UPDATE_UNIT_SDATE;
	EXECUTE UPDATE_UNIT_SDATE_STMT;
	
	SET @UPDATE_UNIT_EDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.UNIT_DETAILS SET UD_END_DATE = @EDATE WHERE UD_END_DATE = @SDATE'));
	PREPARE UPDATE_UNIT_EDATE_STMT FROM @UPDATE_UNIT_EDATE;
	EXECUTE UPDATE_UNIT_EDATE_STMT;
	
--UPDATE QUERY FOR UNIT_ACCESS_STAMP_DETAILS TABLE
	SET @UPDATE_UASD_STAMPDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.UNIT_ACCESS_STAMP_DETAILS SET UASD_STAMPDUTYDATE = @EDATE WHERE UASD_STAMPDUTYDATE = @SDATE'));
	PREPARE UPDATE_UASD_STAMPDATE_STMT FROM @UPDATE_UASD_STAMPDATE;
	EXECUTE UPDATE_UASD_STAMPDATE_STMT;
	
-- --UPDATE QUERY FOR CUSTOMER_ENTRY_DETAILS TABLE
	SET @UPDATE_CEDNOTICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_ENTRY_DETAILS SET CED_NOTICE_START_DATE = @EDATE WHERE CED_NOTICE_START_DATE = @SDATE'));
	PREPARE UPDATE_CEDNOTICEDATE_STMT FROM @UPDATE_CEDNOTICEDATE;
	EXECUTE UPDATE_CEDNOTICEDATE_STMT;
	
	SET @UPDATE_CEDCANCELDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_ENTRY_DETAILS SET CED_CANCEL_DATE = @EDATE WHERE CED_CANCEL_DATE = @SDATE'));
	PREPARE UPDATE_CEDCANCELDATE_STMT FROM @UPDATE_CEDCANCELDATE;
	EXECUTE UPDATE_CEDCANCELDATE_STMT;
	
--UPDATE QUERY FOR CUSTOMER_ACCESS_CARD_DETAILS TABLE
	SET @UPDATE_CACDVALIDFROMDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_ACCESS_CARD_DETAILS SET CACD_VALID_FROM = @EDATE WHERE CACD_VALID_FROM = @SDATE'));
	PREPARE UPDATE_CACDVALIDFROMDATE_STMT FROM @UPDATE_CACDVALIDFROMDATE;
	EXECUTE UPDATE_CACDVALIDFROMDATE_STMT;

	SET @UPDATE_TILLDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_ACCESS_CARD_DETAILS SET CACD_VALID_TILL = @EDATE WHERE CACD_VALID_TILL = @SDATE'));
	PREPARE UPDATE_TILLDATE_STMT FROM @UPDATE_TILLDATE;
	EXECUTE UPDATE_TILLDATE_STMT;
	
--UPDATE QUERY FOR CUSTOMER_LP_DETAILS TABLE
	SET @UPDATE_CTDSDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_LP_DETAILS SET CLP_STARTDATE = @EDATE WHERE CLP_STARTDATE = @SDATE'));
	PREPARE UPDATE_CTDSDATE_STMT FROM @UPDATE_CTDSDATE;
	EXECUTE UPDATE_CTDSDATE_STMT;

	SET @UPDATE_CTDEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_LP_DETAILS SET CLP_ENDDATE = @EDATE WHERE CLP_ENDDATE = @SDATE'));
	PREPARE UPDATE_CTDEDATE_STMT FROM @UPDATE_CTDEDATE;
	EXECUTE UPDATE_CTDEDATE_STMT;
	
	SET @UPDATE_CTDPTDDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_LP_DETAILS SET CLP_PRETERMINATE_DATE = @EDATE WHERE CLP_PRETERMINATE_DATE = @SDATE'));
	PREPARE UPDATE_CTDPTDDATE_STMT FROM @UPDATE_CTDPTDDATE;
	EXECUTE UPDATE_CTDPTDDATE_STMT;
	
--UPDATE QUERY FOR CUSTOMER_PERSONAL_DETAILS TABLE
	SET @UPDATE_PASSPORTDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_PERSONAL_DETAILS SET CPD_PASSPORT_DATE = @EDATE WHERE CPD_PASSPORT_DATE = @SDATE'));
	PREPARE UPDATE_PASSPORTDATE_STMT FROM @UPDATE_PASSPORTDATE;
	EXECUTE UPDATE_PASSPORTDATE_STMT;

	SET @UPDATE_DATEOFBIRTH = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_PERSONAL_DETAILS SET CPD_DOB = @EDATE WHERE CPD_DOB = @SDATE'));
	PREPARE UPDATE_DATEOFBIRTH_STMT FROM @UPDATE_DATEOFBIRTH;
	EXECUTE UPDATE_DATEOFBIRTH_STMT;

	SET @UPDATE_EPDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_PERSONAL_DETAILS SET CPD_EP_DATE = @EDATE WHERE CPD_EP_DATE = @SDATE'));
	PREPARE UPDATE_EPDATE_STMT FROM @UPDATE_EPDATE;
	EXECUTE UPDATE_EPDATE_STMT;
	
--UPDATE QUERY FOR PAYMENT_DETAILS TABLE
	SET @UPDATE_PAIDDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.PAYMENT_DETAILS SET PD_PAID_DATE = @EDATE WHERE PD_PAID_DATE = @SDATE'));
	PREPARE UPDATE_PAIDDATE_STMT FROM @UPDATE_PAIDDATE;
	EXECUTE UPDATE_PAIDDATE_STMT;

	SET @UPDATE_FORPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.PAYMENT_DETAILS SET PD_FOR_PERIOD = @EDATE WHERE PD_FOR_PERIOD = @SDATE'));
	PREPARE UPDATE_FORPERIOD_STMT FROM @UPDATE_FORPERIOD;
	EXECUTE UPDATE_FORPERIOD_STMT;
	
--UPDATE QUERY FOR EXPENSE_STAFF_SALARY TABLE
	SET @UPDATE_ESSINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_STAFF_SALARY SET ESS_INVOICE_DATE = @EDATE WHERE ESS_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_ESSINVOICEDATE_STMT FROM @UPDATE_ESSINVOICEDATE;
	EXECUTE UPDATE_ESSINVOICEDATE_STMT;

	SET @UPDATE_ESSFROMPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_STAFF_SALARY SET ESS_FROM_PERIOD = @EDATE WHERE ESS_FROM_PERIOD = @SDATE'));
	PREPARE UPDATE_ESSFROMPERIOD_STMT FROM @UPDATE_ESSFROMPERIOD;
	EXECUTE UPDATE_ESSFROMPERIOD_STMT;

	SET @UPDATE_ESSTOPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_STAFF_SALARY SET ESS_TO_PERIOD = @EDATE WHERE ESS_TO_PERIOD = @SDATE'));
	PREPARE UPDATE_ESSTOPERIOD_STMT FROM @UPDATE_ESSTOPERIOD;
	EXECUTE UPDATE_ESSTOPERIOD_STMT;

--UPDATE QUERY FOR EXPENSE_STAFF TABLE
	SET @UPDATE_ESINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_STAFF SET ES_INVOICE_DATE = @EDATE WHERE ES_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_ESINVOICEDATE_STMT FROM @UPDATE_ESINVOICEDATE;
	EXECUTE UPDATE_ESINVOICEDATE_STMT;
	
--UPDATE QUERY FOR EXPENSE_AGENT TABLE
	SET @UPDATE_EAINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_AGENT SET EA_DATE = @EDATE WHERE EA_DATE = @SDATE'));
	PREPARE UPDATE_EAINVOICEDATE_STMT FROM @UPDATE_EAINVOICEDATE;
	EXECUTE UPDATE_EAINVOICEDATE_STMT;
	
--UPDATE QUERY FOR EXPENSE_DETAIL_STARHUB TABLE
	SET @UPDATE_EDSHAPPLDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DETAIL_STARHUB SET EDSH_APPL_DATE = @EDATE WHERE EDSH_APPL_DATE = @SDATE'));
	PREPARE UPDATE_EDSHAPPLDATE_STMT FROM @UPDATE_EDSHAPPLDATE;
	EXECUTE UPDATE_EDSHAPPLDATE_STMT;

	SET @UPDATE_EDSHCABLESDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DETAIL_STARHUB SET EDSH_CABLE_START_DATE = @EDATE WHERE EDSH_CABLE_START_DATE = @SDATE'));
	PREPARE UPDATE_EDSHCABLESDATE_STMT FROM @UPDATE_EDSHCABLESDATE;
	EXECUTE UPDATE_EDSHCABLESDATE_STMT;

	SET @UPDATE_EDSHCABLEEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DETAIL_STARHUB SET EDSH_CABLE_END_DATE = @EDATE WHERE EDSH_CABLE_END_DATE = @SDATE'));
	PREPARE UPDATE_EDSHCABLEEDATE_STMT FROM @UPDATE_EDSHCABLEEDATE;
	EXECUTE UPDATE_EDSHCABLEEDATE_STMT;

	SET @UPDATE_EDSHINTERNETSDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DETAIL_STARHUB SET EDSH_INTERNET_START_DATE = @EDATE WHERE EDSH_INTERNET_START_DATE = @SDATE'));
	PREPARE UPDATE_EDSHINTERNETSDATE_STMT FROM @UPDATE_EDSHINTERNETSDATE;
	EXECUTE UPDATE_EDSHINTERNETSDATE_STMT;

	SET @UPDATE_EDSHINTERNETEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DETAIL_STARHUB SET EDSH_INTERNET_END_DATE = @EDATE WHERE EDSH_INTERNET_END_DATE = @SDATE'));
	PREPARE UPDATE_EDSHINTERNETEDATE_STMT FROM @UPDATE_EDSHINTERNETEDATE;
	EXECUTE UPDATE_EDSHINTERNETEDATE_STMT;
	
--UPDATE QUERY FOR EXPENSE_UNIT TABLE
	SET @UPDATE_EUINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_UNIT SET EU_INVOICE_DATE = @EDATE WHERE EU_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_EUINVOICEDATE_STMT FROM @UPDATE_EUINVOICEDATE;
	EXECUTE UPDATE_EUINVOICEDATE_STMT;

--UPDATE QUERY FOR EXPENSE_ELECTRICITY TABLE
	SET @UPDATE_EEINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_ELECTRICITY SET EE_INVOICE_DATE = @EDATE WHERE EE_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_EEINVOICEDATE_STMT FROM @UPDATE_EEINVOICEDATE;
	EXECUTE UPDATE_EEINVOICEDATE_STMT;

	SET @UPDATE_EEFROMPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_ELECTRICITY SET EE_FROM_PERIOD = @EDATE WHERE EE_FROM_PERIOD = @SDATE'));
	PREPARE UPDATE_EEFROMPERIOD_STMT FROM @UPDATE_EEFROMPERIOD;
	EXECUTE UPDATE_EEFROMPERIOD_STMT;

	SET @UPDATE_EETOPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_ELECTRICITY SET EE_TO_PERIOD = @EDATE WHERE EE_TO_PERIOD = @SDATE'));
	PREPARE UPDATE_EETOPERIOD_STMT FROM @UPDATE_EETOPERIOD;
	EXECUTE UPDATE_EETOPERIOD_STMT;

--UPDATE QUERY FOR EXPENSE_STARHUB TABLE
	SET @UPDATE_ESHINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_STARHUB SET ESH_INVOICE_DATE = @EDATE WHERE ESH_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_ESHINVOICEDATE_STMT FROM @UPDATE_ESHINVOICEDATE;
	EXECUTE UPDATE_ESHINVOICEDATE_STMT;

	SET @UPDATE_ESHFROMPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_STARHUB SET ESH_FROM_PERIOD = @EDATE WHERE ESH_FROM_PERIOD = @SDATE'));
	PREPARE UPDATE_ESHFROMPERIOD_STMT FROM @UPDATE_ESHFROMPERIOD;
	EXECUTE UPDATE_ESHFROMPERIOD_STMT;

	SET @UPDATE_ESHTOPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_STARHUB SET ESH_TO_PERIOD = @EDATE WHERE ESH_TO_PERIOD = @SDATE'));
	PREPARE UPDATE_ESHTOPERIOD_STMT FROM @UPDATE_ESHTOPERIOD;
	EXECUTE UPDATE_ESHTOPERIOD_STMT;
	
--UPDATE QUERY FOR EXPENSE_DIGITAL_VOICE TABLE
	SET @UPDATE_DVINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DIGITAL_VOICE SET EDV_INVOICE_DATE = @EDATE WHERE EDV_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_DVINVOICEDATE_STMT FROM @UPDATE_DVINVOICEDATE;
	EXECUTE UPDATE_DVINVOICEDATE_STMT;

	SET @UPDATE_DVFROMPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DIGITAL_VOICE SET EDV_FROM_PERIOD = @EDATE WHERE EDV_FROM_PERIOD = @SDATE'));
	PREPARE UPDATE_DVFROMPERIOD_STMT FROM @UPDATE_DVFROMPERIOD;
	EXECUTE UPDATE_DVFROMPERIOD_STMT;

	SET @UPDATE_DVTOPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DIGITAL_VOICE SET EDV_TO_PERIOD = @EDATE WHERE EDV_TO_PERIOD = @SDATE'));
	PREPARE UPDATE_DVTOPERIOD_STMT FROM @UPDATE_DVTOPERIOD;
	EXECUTE UPDATE_DVTOPERIOD_STMT;
	
--UPDATE QUERY FOR EXPENSE_FACILITY_USE TABLE
	SET @UPDATE_FUINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_FACILITY_USE SET EFU_INVOICE_DATE = @EDATE WHERE EFU_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_FUINVOICEDATE_STMT FROM @UPDATE_FUINVOICEDATE;
	EXECUTE UPDATE_FUINVOICEDATE_STMT;

--UPDATE QUERY FOR EXPENSE_CARPARK TABLE
	SET @UPDATE_CARINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_CARPARK SET ECP_INVOICE_DATE = @EDATE WHERE ECP_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_CARINVOICEDATE_STMT FROM @UPDATE_CARINVOICEDATE;
	EXECUTE UPDATE_CARINVOICEDATE_STMT;

	SET @UPDATE_CP_FROMPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_CARPARK SET ECP_FROM_PERIOD = @EDATE WHERE ECP_FROM_PERIOD = @SDATE'));
	PREPARE UPDATE_CP_FROMPERIOD_STMT FROM @UPDATE_CP_FROMPERIOD;
	EXECUTE UPDATE_CP_FROMPERIOD_STMT;

	SET @UPDATE_CPTOPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_CARPARK SET ECP_TO_PERIOD = @EDATE WHERE ECP_TO_PERIOD = @SDATE'));
	PREPARE UPDATE_CPTOPERIOD_STMT FROM @UPDATE_CPTOPERIOD;
	EXECUTE UPDATE_CPTOPERIOD_STMT;
	
--UPDATE QUERY FOR EXPENSE_MOVING_IN_AND_OUT  TABLE
	SET @UPDATE_MIOINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_MOVING_IN_AND_OUT  SET EMIO_INVOICE_DATE = @EDATE WHERE EMIO_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_MIOINVOICEDATE_STMT FROM @UPDATE_MIOINVOICEDATE;
	EXECUTE UPDATE_MIOINVOICEDATE_STMT;

--UPDATE QUERY FOR EXPENSE_AIRCON_SERVICE  TABLE
	SET @UPDATE_EAINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_AIRCON_SERVICE  SET EAS_DATE = @EDATE WHERE EAS_DATE = @SDATE'));
	PREPARE UPDATE_EAINVOICEDATE_STMT FROM @UPDATE_EAINVOICEDATE;
	EXECUTE UPDATE_EAINVOICEDATE_STMT;

--UPDATE QUERY FOR EXPENSE_PURCHASE_NEW_CARD  TABLE
	SET @UPDATE_EPNCINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_PURCHASE_NEW_CARD  SET EPNC_INVOICE_DATE = @EDATE WHERE EPNC_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_EPNCINVOICEDATE_STMT FROM @UPDATE_EPNCINVOICEDATE;
	EXECUTE UPDATE_EPNCINVOICEDATE_STMT;
	
--UPDATE QUERY FOR EXPENSE_PETTY_CASH  TABLE
	SET @UPDATE_PCINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_PETTY_CASH  SET EPC_DATE = @EDATE WHERE EPC_DATE = @SDATE'));
	PREPARE UPDATE_PCINVOICEDATE_STMT FROM @UPDATE_PCINVOICEDATE;
	EXECUTE UPDATE_PCINVOICEDATE_STMT;

--UPDATE QUERY FOR EXPENSE_HOUSEKEEPING  TABLE
	SET @UPDATE_HKINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_HOUSEKEEPING  SET EHK_WORK_DATE = @EDATE WHERE EHK_WORK_DATE = @SDATE'));
	PREPARE UPDATE_HKINVOICEDATE_STMT FROM @UPDATE_HKINVOICEDATE;
	EXECUTE UPDATE_HKINVOICEDATE_STMT;

--UPDATE QUERY FOR EXPENSE_HOUSEKEEPING  TABLE
	SET @UPDATE_HKINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_HOUSEKEEPING  SET EHK_WORK_DATE = @EDATE WHERE EHK_WORK_DATE = @SDATE'));
	PREPARE UPDATE_HKINVOICEDATE_STMT FROM @UPDATE_HKINVOICEDATE;
	EXECUTE UPDATE_HKINVOICEDATE_STMT;

--UPDATE QUERY FOR EXPENSE_HOUSEKEEPING_PAYMENT  TABLE
	SET @UPDATE_HKPFORPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_HOUSEKEEPING_PAYMENT  SET EHKP_FOR_PERIOD = @EDATE WHERE EHKP_FOR_PERIOD = @SDATE'));
	PREPARE UPDATE_HKPFORPERIOD_STMT FROM @UPDATE_HKPFORPERIOD;
	EXECUTE UPDATE_HKPFORPERIOD_STMT;

	SET @UPDATE_HKPPAIDDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_HOUSEKEEPING_PAYMENT  SET EHKP_PAID_DATE = @EDATE WHERE EHKP_PAID_DATE = @SDATE'));
	PREPARE UPDATE_HKPPAIDDATE_STMT FROM @UPDATE_HKPPAIDDATE;
	EXECUTE UPDATE_HKPPAIDDATE_STMT;

--UPDATE QUERY FOR EXPENSE_PERSONAL TABLE
	SET @UPDATE_EP_INVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_PERSONAL SET EP_INVOICE_DATE = @EDATE WHERE EP_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_EP_INVOICEDATE_STMT FROM @UPDATE_EP_INVOICEDATE;
	EXECUTE UPDATE_EP_INVOICEDATE_STMT;
	
--UPDATE QUERY FOR EXPENSE_CAR TABLE
	SET @UPDATE_EC_INVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_CAR SET EC_INVOICE_DATE = @EDATE WHERE EC_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_EC_INVOICEDATE_STMT FROM @UPDATE_EC_INVOICEDATE;
	EXECUTE UPDATE_EC_INVOICEDATE_STMT;
	
--UPDATE QUERY FOR EXPENSE_BABY TABLE
	SET @UPDATE_EB_INVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_BABY SET EB_INVOICE_DATE = @EDATE WHERE EB_INVOICE_DATE = @SDATE'));
	PREPARE UPDATE_EB_INVOICEDATE_STMT FROM @UPDATE_EB_INVOICEDATE;
	EXECUTE UPDATE_EB_INVOICEDATE_STMT;
	
--UPDATE QUERY FOR EXPENSE_CAR_LOAN TABLE
	SET @UPDATE_CLINVOICEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_CAR_LOAN SET ECL_PAID_DATE = @EDATE WHERE ECL_PAID_DATE = @SDATE'));
	PREPARE UPDATE_CLINVOICEDATE_STMT FROM @UPDATE_CLINVOICEDATE;
	EXECUTE UPDATE_CLINVOICEDATE_STMT;

	SET @UPDATE_CL_FROMPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_CAR_LOAN SET ECL_FROM_PERIOD = @EDATE WHERE ECL_FROM_PERIOD = @SDATE'));
	PREPARE UPDATE_CL_FROMPERIOD_STMT FROM @UPDATE_CL_FROMPERIOD;
	EXECUTE UPDATE_CL_FROMPERIOD_STMT;

	SET @UPDATE_CLTOPERIOD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_CAR_LOAN SET ECL_TO_PERIOD = @EDATE WHERE ECL_TO_PERIOD = @SDATE'));
	PREPARE UPDATE_CLTOPERIOD_STMT FROM @UPDATE_CLTOPERIOD;
	EXECUTE UPDATE_CLTOPERIOD_STMT;
	
--UPDATE QUERY FOR USER_ACCESS TABLE
	SET @UPDATE_USER_JOINDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.USER_ACCESS SET UA_JOIN_DATE = @EDATE WHERE UA_JOIN_DATE = @SDATE'));
	PREPARE UPDATE_USER_JOINDATE_STMT FROM @UPDATE_USER_JOINDATE;
	EXECUTE UPDATE_USER_JOINDATE_STMT;

	SET @UPDATE_USER_ENDDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.USER_ACCESS SET UA_END_DATE = @EDATE WHERE UA_END_DATE = @SDATE'));
	PREPARE UPDATE_USER_ENDDATE_STMT FROM @UPDATE_USER_ENDDATE;
	EXECUTE UPDATE_USER_ENDDATE_STMT;
	
--UPDATE QUERY FOR PUBLIC_HOLIDAY TABLE
	SET @UPDATE_HOLIDAYDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.PUBLIC_HOLIDAY SET PH_DATE = @EDATE WHERE PH_DATE = @SDATE'));
	PREPARE UPDATE_HOLIDAYDATE_STMT FROM @UPDATE_HOLIDAYDATE;
	EXECUTE UPDATE_HOLIDAYDATE_STMT;
	
--UPDATE QUERY FOR BANK_TRANSFER TABLE
	SET @UPDATE_BTDATE= (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.BANK_TRANSFER SET BT_DATE = @EDATE WHERE BT_DATE = @SDATE'));
	PREPARE UPDATE_BTDATE_STMT FROM @UPDATE_BTDATE;
	EXECUTE UPDATE_BTDATE_STMT;

	SET @UPDATE_DEBITEDDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.BANK_TRANSFER SET BT_DEBITED_ON = @EDATE WHERE BT_DEBITED_ON = @SDATE'));
	PREPARE UPDATE_DEBITEDDATE_STMT FROM @UPDATE_DEBITEDDATE;
	EXECUTE UPDATE_DEBITEDDATE_STMT;
	
--UPDATE QUERY FOR CHEQUE_ENTRY_DETAILS TABLE
	SET @UPDATE_CHEQUE_DATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CHEQUE_ENTRY_DETAILS SET CHEQUE_DATE = @EDATE WHERE CHEQUE_DATE = @SDATE'));
	PREPARE UPDATE_CHEQUE_DATE_STMT FROM @UPDATE_CHEQUE_DATE;
	EXECUTE UPDATE_CHEQUE_DATE_STMT;

	SET @UPDATE_CHEQUE_DEBITED_DATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CHEQUE_ENTRY_DETAILS SET CHEQUE_DEBITED_RETURNED_DATE = @EDATE WHERE CHEQUE_DEBITED_RETURNED_DATE = @SDATE'));
	PREPARE UPDATE_CHEQUE_DEBITED_DATE_STMT FROM @UPDATE_CHEQUE_DEBITED_DATE;
	EXECUTE UPDATE_CHEQUE_DEBITED_DATE_STMT;
	
--UPDATE QUERY FOR OCBC_BANK_RECORDS TABLE
	SET @UPDATE_OBRPOSTDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.OCBC_BANK_RECORDS SET OBR_POST_DATE = @EDATE WHERE OBR_POST_DATE = @SDATE'));
	PREPARE UPDATE_OBRPOSTDATE_STMT FROM @UPDATE_OBRPOSTDATE;
	EXECUTE UPDATE_OBRPOSTDATE_STMT;
	
	SET @UPDATE_OBRTRANSDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.OCBC_BANK_RECORDS SET OBR_TRANS_DATE = @EDATE WHERE OBR_TRANS_DATE = @SDATE'));
	PREPARE UPDATE_OBRTRANSDATE_STMT FROM @UPDATE_OBRTRANSDATE;
	EXECUTE UPDATE_OBRTRANSDATE_STMT;

	SET @UPDATE_OBRVALUEDATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.OCBC_BANK_RECORDS SET OBR_VALUE_DATE = @EDATE WHERE OBR_VALUE_DATE = @SDATE'));
	PREPARE UPDATE_OBRVALUEDATE_STMT FROM @UPDATE_OBRVALUEDATE;
	EXECUTE UPDATE_OBRVALUEDATE_STMT;
	
--UPDATE QUERY FOR ERM_ENTRY_DETAILS TABLE
	SET @UPDATE_ERMMOVING_DATE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.ERM_ENTRY_DETAILS SET ERM_MOVING_DATE = @EDATE WHERE ERM_MOVING_DATE = @SDATE'));
	PREPARE UPDATE_ERMMOVING_DATE_STMT FROM @UPDATE_ERMMOVING_DATE;
	EXECUTE UPDATE_ERMMOVING_DATE_STMT;
	COMMIT;	
END;

CALL SP_UPDATE_DATE_19700101_TO_19700102(DESTINATIONSCHEMA);
