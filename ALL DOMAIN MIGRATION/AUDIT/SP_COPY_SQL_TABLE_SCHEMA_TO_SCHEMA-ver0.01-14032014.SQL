--version:0.1--sdate:13/03/2014 --edate:13/03/2014 --issue:743 -desc:CREATED SP FOR COPYING TABLE DATA'S ONE SCHEMA TO ANOTHER SCHEMA  done by:KUMAR R
DROP PROCEDURE IF EXISTS SP_DYNAMIC_TABLE;
CREATE PROCEDURE SP_DYNAMIC_TABLE
(
TABLENAME VARCHAR(60),
SOURCESCHEMA VARCHAR(20),
DESTSCHEMA VARCHAR(20),
SOURCECOUNT INTEGER(5),
DESTINATIONCOUNT INTEGER(5)
)

BEGIN

SET @DROPQUERY=(SELECT CONCAT('DROP TABLE IF EXISTS ',DESTSCHEMA,'.',TABLENAME));
SET @CREATEQUERY=(SELECT CONCAT('CREATE TABLE ', DESTSCHEMA,'.',TABLENAME,' AS SELECT * FROM ',SOURCESCHEMA,'.',TABLENAME));

PREPARE  STMT2 from @DROPQUERY;
EXECUTE STMT2 ;
PREPARE  STMT3 from @CREATEQUERY;
EXECUTE STMT3 ;
SET @SOURCETABLECOUNT=(SELECT CONCAT('SELECT COUNT(*) INTO @SOURCEROWSCOUNT FROM ',SOURCESCHEMA,'.',TABLENAME));
PREPARE STMT1 FROM @SOURCETABLECOUNT;
EXECUTE STMT1;
SET @DESTABLECOUNT=(SELECT CONCAT('SELECT COUNT(*)INTO @DESROWSCOUNT FROM ',DESTSCHEMA,'.',TABLENAME));
PREPARE  STMT4 from @DESTABLECOUNT;
EXECUTE STMT4 ;
SET SOURCECOUNT=(SELECT @SOURCEROWSCOUNT);
SET DESTINATIONCOUNT=(SELECT @DESROWSCOUNT);
END;