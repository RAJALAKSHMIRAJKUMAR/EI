--VER 0.3 ISSUE NO:345 COMMENT #714 STARTDATE:18/06/2014 ENDDATE:18/06/2014 DESC:CHANGED TEMP VIEW NAME AS SUB DONEBY:SASIKALA
--VER 0.2 ISSUE NO:641 COMMENT #20 STARTDATE:10/12/2013 ENDDATE:10/12/2013 
--DESC:ADD URC_ID AND URC_DATA IN ACCESS RIGHTS LOGIN TERMINATION VIEW DONE BY:RL
--VER 0.1 ISSUE NO:641 COMMENT #3 STARTDATE:07/12/2013 ENDDATE:09/12/2013 DESC:VIEW FOR SITE ACCESS USER 
--DONE BY:DHIVYA.A

--TEMP VIEW FOR GETTING MAX REC VER
CREATE OR REPLACE VIEW VW_SUB_ACCESS_RIGHTS_MAXRECVER AS SELECT ULD_ID,MAX(UA_REC_VER) AS RECVER 
FROM USER_ACCESS GROUP BY ULD_ID;

--VIEW FOR ACCESS RIGHTS ACTIVE LOGINID
CREATE OR REPLACE VIEW VW_ACCESS_RIGHTS_TERMINATE_LOGINID AS
SELECT ULD.ULD_LOGINID,URCN.URC_ID,URCN.URC_DATA FROM USER_LOGIN_DETAILS ULD,USER_ACCESS UA,
VW_SUB_ACCESS_RIGHTS_MAXRECVER V,USER_RIGHTS_CONFIGURATION URCN,ROLE_CREATION RC WHERE 
ULD.ULD_ID=UA.ULD_ID AND UA.UA_REC_VER=V.RECVER AND V.ULD_ID=UA.ULD_ID AND V.ULD_ID=ULD.ULD_ID AND 
UA.RC_ID=RC.RC_ID AND RC.URC_ID=URCN.URC_ID AND UA.UA_TERMINATE IS NULL GROUP BY ULD.ULD_ID;

--VIEW FOR ACCESS RIGHTS REJOIN LOGIN ID
CREATE OR REPLACE VIEW VW_ACCESS_RIGHTS_REJOIN_LOGINID AS
SELECT ULD.ULD_LOGINID FROM USER_LOGIN_DETAILS ULD,USER_ACCESS UA,VW_SUB_ACCESS_RIGHTS_MAXRECVER V WHERE 
ULD.ULD_ID=UA.ULD_ID AND UA.UA_REC_VER=V.RECVER AND V.ULD_ID=UA.ULD_ID AND V.ULD_ID=ULD.ULD_ID AND 
UA.UA_TERMINATE IS NOT NULL GROUP BY ULD.ULD_ID;


