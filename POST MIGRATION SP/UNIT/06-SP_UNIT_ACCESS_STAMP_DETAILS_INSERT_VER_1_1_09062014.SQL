DROP PROCEDURE IF EXISTS SP_UNIT_ACCESS_STAMP_DETAILS_INSERT;
CREATE PROCEDURE SP_UNIT_ACCESS_STAMP_DETAILS_INSERT(IN DESTINATIONSCHEMA VARCHAR(50))
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN 
ROLLBACK;
END;
START TRANSACTION;
		SET @INSERTUASDQUERY = (SELECT CONCAT('INSERT INTO ',DESTINATIONSCHEMA,'.UNIT_ACCESS_STAMP_DETAILS
		(UNIT_ID,USDT_ID,UASD_STAMPDUTYDATE,UASD_STAMPDUTYAMT,
        UASD_ACCESS_CARD,UASD_ACCESS_ACTIVE,UASD_ACCESS_INVENTORY,UASD_ACCESS_LOST,URTD_ID,UASD_COMMENTS,ULD_ID,UASD_TIMESTAMP)
		SELECT UNIT_ID,USDT_ID,UASD_STAMPDUTYDATE,UASD_STAMPDUTYAMT,
        UASD_ACCESS_CARD,UASD_ACCESS_ACTIVE,UASD_ACCESS_INVENTORY,UASD_ACCESS_LOST,URTD_ID,UASD_COMMENTS,ULD_ID,UASD_TIMESTAMP
		FROM ',DESTINATIONSCHEMA,'.TEMP_UNIT_ACCESS_STAMP_DETAILS'));
		PREPARE INSERTUASDQUERYSTMT FROM @INSERTUASDQUERY;
		EXECUTE INSERTUASDQUERYSTMT;
COMMIT;
END;
