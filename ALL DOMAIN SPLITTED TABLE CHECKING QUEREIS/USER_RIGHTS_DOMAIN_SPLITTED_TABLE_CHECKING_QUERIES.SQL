-- MENU PROFILE
SELECT EP_ID, FP_ID, MP_MNAME, MP_MSUB, MP_MSUBMENU, MP_MFILENAME FROM S_29052014.USER_RIGHTS_SQL_FORMAT WHERE MP_MNAME IS NOT NULL AND MP_MFILENAME IS NOT NULL;
SELECT * FROM MENU_PROFILE;

-- ROLE CREATION
SELECT DISTINCT ROLES,RACESS,USERSTAMP,TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE ROLES IS NOT NULL GROUP BY ROLES;
SELECT * FROM ROLE_CREATION;

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE ROLES IS NOT NULL  GROUP BY ROLES;
SELECT ADDTIME(RC_TIMESTAMP,'8:00')FROM ROLE_CREATION;

SELECT A.USERSTAMP,C.RC_USERSTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT A,ROLE_CREATION C WHERE A.USERSTAMP=C.RC_USERSTAMP AND A.ROLES IS NOT NULL GROUP BY A.ROLES;

-- FILE_PROFILE
SELECT FP_FOLDER_ID,FP_FILE_ID,FP_FILE_FLAG FROM S_29052014.USER_RIGHTS_SQL_FORMAT WHERE FP_FOLDER_ID IS NOT NULL;
SELECT * FROM FILE_PROFILE;

-- USER_LOGIN_DETAILS
SELECT DISTINCT(UNAME),USERSTAMP,TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE UNAME IS NOT NULL ORDER BY UNAME ASC;
SELECT * FROM USER_LOGIN_DETAILS;

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE UNAME IS NOT NULL  GROUP BY UNAME;
SELECT ADDTIME(ULD_TIMESTAMP,'8:00')FROM USER_LOGIN_DETAILS;

SELECT DISTINCT(A.UNAME),A.USERSTAMP,C.ULD_USERSTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT A,USER_LOGIN_DETAILS C WHERE A.USERSTAMP=C.ULD_USERSTAMP AND A.UNAME IS NOT NULL ORDER BY UNAME ASC;

-- USER_ACCESS
SELECT UNAME,URECVER,UJOIN,UTERMINATE,UJDATE,UEDATE,UREASON,USERSTAMP,URROLES,TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE UNAME IS NOT NULL;
SELECT * FROM USER_ACCESS;

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE UNAME IS NOT NULL;
SELECT ADDTIME(UA_TIMESTAMP,'8:00')FROM USER_ACCESS;

SELECT DISTINCT(A.UNAME),A.USERSTAMP,C.UA_USERSTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT A,USER_ACCESS C WHERE A.USERSTAMP=C.UA_USERSTAMP AND A.UNAME IS NOT NULL;

-- BASIC_ROLE_PROFILE
SELECT URSF.URC_ID, URSF.BRP_BR_ID, ULD.ULD_ID ,URSF.TIMESTAMP FROM D_29052014.USER_LOGIN_DETAILS ULD , S_29052014.USER_RIGHTS_SQL_FORMAT URSF WHERE ULD.ULD_LOGINID=URSF.USERSTAMP AND URSF.URC_ID IS NOT NULL AND URSF.BRP_BR_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL;
SELECT * FROM BASIC_ROLE_PROFILE;

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SQL_FORMAT URSF WHERE URSF.URC_ID IS NOT NULL AND URSF.BRP_BR_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL;
SELECT BRP_TIMESTAMP FROM BASIC_ROLE_PROFILE;

SELECT DISTINCT ULD_ID FROM BASIC_ROLE_PROFILE;
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM S_29052014.USER_RIGHTS_SQL_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN BASIC_ROLE_PROFILE C ON B.ULD_ID=C.ULD_ID;

-- BASIC_MENU_PROFILE
SELECT URSF.URC_ID,URSF.MP_ID,ULD.ULD_ID,URSF.TIMESTAMP FROM D_29052014.USER_LOGIN_DETAILS ULD,S_29052014.USER_RIGHTS_SQL_FORMAT URSF WHERE ULD.ULD_LOGINID=URSF.USERSTAMP AND URC_ID IS NOT NULL AND MP_ID IS NOT NULL AND USERSTAMP IS NOT NULL;
SELECT * FROM BASIC_MENU_PROFILE;

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SQL_FORMAT URSF WHERE URSF.URC_ID IS NOT NULL AND URSF.MP_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL;
SELECT BMP_TIMESTAMP FROM BASIC_MENU_PROFILE;

SELECT DISTINCT ULD_ID FROM BASIC_MENU_PROFILE;
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM S_29052014.USER_RIGHTS_SQL_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN BASIC_MENU_PROFILE C ON B.ULD_ID=C.ULD_ID;

-- PUBLIC_HOLIDAY
SELECT PH_DESCRIPTION,PH_DATE FROM S_29052014.USER_RIGHTS_SQL_FORMAT WHERE PH_DESCRIPTION IS NOT NULL AND PH_DATE IS NOT NULL;
SELECT * FROM PUBLIC_HOLIDAY;

-- STORED_PROCEDURE_PROFILE
SELECT SPP_NAME FROM S_29052014.USER_RIGHTS_SQL_FORMAT WHERE SPP_NAME IS NOT NULL;
SELECT * FROM STORED_PROCEDURE_PROFILE;

-- VIEW_PROFILE
SELECT VP_NAME FROM S_29052014.USER_RIGHTS_SQL_FORMAT WHERE VP_NAME IS NOT NULL;
SELECT * FROM VIEW_PROFILE;

-- PLATFORM_MANAGEMENT
SELECT MP_ID,POSTAP_ID,SPP_ID,VP_ID FROM S_29052014.USER_RIGHTS_SQL_FORMAT WHERE MP_ID IS NOT NULL AND PM_ID IS NOT NULL;
SELECT * FROM PLATFORM_MANAGEMENT;	

-- USER_MENU_DETAILS
SELECT * FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE Mroles='ADMIN';
SELECT * FROM USER_MENU_DETAILS WHERE RC_ID=1;

SELECT * FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE Mroles='SUPER ADMIN';
SELECT * FROM USER_MENU_DETAILS WHERE RC_ID=2; -- EXTRA MENU IN SQL TABLE

SELECT * FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE Mroles='USER';
SELECT * FROM USER_MENU_DETAILS WHERE RC_ID=3;

SELECT * FROM S_29052014.USER_RIGHTS_SCDB_FORMAT WHERE Mroles='USER1';
SELECT * FROM USER_MENU_DETAILS WHERE RC_ID=4;

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT URSF WHERE Mroles='ADMIN';
SELECT ADDTIME(MD_TIMESTAMP,'8:00') FROM USER_MENU_DETAILS WHERE RC_ID=1;

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT URSF WHERE Mroles='SUPER ADMIN' AND TIMESTAMP IS NOT NULL; -- 73
SELECT ADDTIME(MD_TIMESTAMP,'8:00') FROM USER_MENU_DETAILS WHERE RC_ID=2; -- 82 (EXTRA MENU IN SQL TABLE)

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT URSF WHERE Mroles='USER';
SELECT ADDTIME(MD_TIMESTAMP,'8:00') FROM USER_MENU_DETAILS WHERE RC_ID=3;

SELECT TIMESTAMP FROM S_29052014.USER_RIGHTS_SCDB_FORMAT URSF WHERE Mroles='USER1';
SELECT ADDTIME(MD_TIMESTAMP,'8:00') FROM USER_MENU_DETAILS WHERE RC_ID=4;

SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM S_29052014.USER_RIGHTS_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN USER_MENU_DETAILS C ON B.ULD_ID=C.ULD_ID AND (A.Mroles='ADMIN' OR A.Mroles='USER' OR A.Mroles='USER1');
SELECT DISTINCT ULD_ID FROM USER_MENU_DETAILS;

-- USER_FILE_DETAILS
SELECT * FROM USER_FILE_DETAILS; -- 23 DATA'S



