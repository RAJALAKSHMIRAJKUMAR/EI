-- EXPENSE_PERSONAL
SELECT*FROM EXPENSE_PERSONAL;
SELECT * FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='PERSONAL';

-- ECN_ID
SELECT DISTINCT ECN_ID FROM EXPENSE_PERSONAL;
SELECT ECN_ID FROM EXPENSE_CONFIGURATION WHERE ECN_DATA IN ('CLOTHING','FOOD & BEVERAGE','FURNITURE','HEALTH & BEAUTY','OTHERS','TRANSPORTATION') AND CGN_ID=24;
SELECT DISTINCT PPE.PE_PERSONAL_EXPENSE ,EC.ECN_DATA ,EC.ECN_ID , EP.ECN_ID FROM S_29052014.PERSONAL_SCDB_FORMAT PPE
INNER JOIN EXPENSE_CONFIGURATION EC ON PPE.PE_PERSONAL_EXPENSE =EC.ECN_DATA INNER JOIN EXPENSE_PERSONAL EP ON EC.ECN_ID = EP.ECN_ID WHERE PPE.PE_TYPE_OF_EXPENSE='PERSONAL' AND EC.CGN_ID=24;

-- INVOICE DATE
SELECT DISTINCT EP_INVOICE_DATE FROM EXPENSE_PERSONAL WHERE EP_INVOICE_DATE IS NOT NULL;
SELECT DISTINCT PE_PERSONAL_INVOICE_DATE FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_PERSONAL_INVOICE_DATE IS NOT NULL;
SELECT DISTINCT EP.EP_INVOICE_DATE,PSF.PE_PERSONAL_INVOICE_DATE FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_PERSONAL EP WHERE EP.EP_INVOICE_DATE=PSF.PE_PERSONAL_INVOICE_DATE; 

-- EP_AMOUNT
SELECT DISTINCT EP.EP_AMOUNT,PSF.PE_PERSONAL_AMOUNT FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_PERSONAL EP WHERE  EP.EP_AMOUNT=PSF.PE_PERSONAL_AMOUNT;
SELECT DISTINCT PE_PERSONAL_AMOUNT FROM SOURCE_04062014. PERSONAL_SCDB_FORMAT WHERE PE_PERSONAL_AMOUNT NOT IN (SELECT  EP_AMOUNT FROM EXPENSE_PERSONAL);
DEST = 7.35 BUT IN SOURCE = 7.354;

-- EP_INVOICE_ITEMS
SELECT DISTINCT EP_INVOICE_ITEMS FROM EXPENSE_PERSONAL WHERE EP_INVOICE_ITEMS IS NOT NULL;
SELECT DISTINCT PE_PERSONAL_INVOICE_ITEMS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT  WHERE PE_TYPE_OF_EXPENSE='PERSONAL' AND PE_PERSONAL_INVOICE_ITEMS IS NOT NULL;
SELECT DISTINCT EP.EP_INVOICE_ITEMS,PSF.PE_PERSONAL_INVOICE_ITEMS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_PERSONAL EP WHERE  EP.EP_INVOICE_ITEMS=PSF.PE_PERSONAL_INVOICE_ITEMS;

-- EP_INVOICE_FROM
SELECT DISTINCT EP_INVOICE_FROM FROM EXPENSE_PERSONAL WHERE EP_INVOICE_FROM IS NOT NULL;
SELECT DISTINCT PE_PERSONAL_INVOICE_FROM FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='PERSONAL' AND PE_PERSONAL_INVOICE_FROM IS NOT NULL;
SELECT DISTINCT  EP. EP_INVOICE_FROM,PSF.PE_PERSONAL_INVOICE_FROM FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_PERSONAL EP WHERE  EP. EP_INVOICE_FROM=PSF.PE_PERSONAL_INVOICE_FROM;

-- EP_COMMENTS
SELECT DISTINCT EP_COMMENTS FROM EXPENSE_PERSONAL WHERE EP_COMMENTS IS NOT NULL;
SELECT DISTINCT PE_PERSONAL_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='PERSONAL' AND PE_PERSONAL_COMMENTS IS NOT NULL;
SELECT DISTINCT PSF.PE_PERSONAL_COMMENTS,EP.EP_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF,EXPENSE_PERSONAL EP WHERE PSF.PE_PERSONAL_COMMENTS=EP.EP_COMMENTS AND PSF.PE_TYPE_OF_EXPENSE='PERSONAL';

SELECT DISTINCT EP.EP_COMMENTS FROM EXPENSE_PERSONAL EP WHERE  NOT EXISTS (SELECT DISTINCT PSF.PE_PERSONAL_COMMENTS FROM   SOURCE_04062014.PERSONAL_SCDB_FORMAT  PSF
                  WHERE  PSF.PE_PERSONAL_COMMENTS=EP.EP_COMMENTS);
                  
                  SELECT * FROM EXPENSE_PERSONAL WHERE EP_COMMENTS LIKE '%Grace:%' 07/10/2011 Meals%

By: Io Ji Cafï¿½ Pte Ltd

SELECT PE_PERSONAL_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT  WHERE PE_PERSONAL_INVOICE_DATE='2011-09-29';
SELECT PE_PERSONAL_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT  WHERE PE_PERSONAL_COMMENTS LIKE '%01/08/2012 Spicy%';


-- ULDID
SELECT DISTINCT ULD_ID FROM EXPENSE_PERSONAL;
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID
INNER JOIN EXPENSE_PERSONAL C ON B.ULD_ID=C.ULD_ID;

-- TIMESTAMP
SELECT DISTINCT EP_TIMESTAMP FROM EXPENSE_PERSONAL;
SELECT DISTINCT TIMESTAMP FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='PERSONAL';
SELECT DISTINCT SUBTIME(PSF.TIMESTAMP,'08:00:00'),EP.EP_TIMESTAMP FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF,EXPENSE_PERSONAL EP WHERE SUBTIME(PSF.TIMESTAMP,'08:00:00')=EP.EP_TIMESTAMP AND PE_TYPE_OF_EXPENSE='PERSONAL';

-- EXPENSE_BABY
SELECT*FROM EXPENSE_BABY;
SELECT * FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='BABY';

-- ECN_ID
SELECT DISTINCT ECN_ID FROM EXPENSE_BABY;
SELECT DISTINCT PE_BABY_EXPENSE FROM  SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='BABY';
SELECT ECN_ID FROM EXPENSE_CONFIGURATION WHERE ECN_DATA IN ('MISCELLANEOUS','HEALTH CARE/HOSPITAL EXPENSES','SCHOOL') AND CGN_ID=25;
SELECT DISTINCT PPE.PE_BABY_EXPENSE ,EC.ECN_DATA ,EC.ECN_ID , EB.ECN_ID FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PPE INNER JOIN EXPENSE_CONFIGURATION EC ON PPE.PE_BABY_EXPENSE =EC.ECN_DATA INNER JOIN EXPENSE_BABY EB ON EC.ECN_ID = EB.ECN_ID WHERE PPE.PE_TYPE_OF_EXPENSE='BABY' AND EC.CGN_ID=25;

-- EB_INVOICE_DATE
SELECT DISTINCT PSF.PE_BABY_INVOICE_DATE,EB.EB_INVOICE_DATE  FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_BABY EB  WHERE PSF.PE_BABY_INVOICE_DATE=EB.EB_INVOICE_DATE;
SELECT DISTINCT EB_INVOICE_DATE FROM EXPENSE_BABY WHERE EB_INVOICE_DATE IS NOT NULL;
SELECT DISTINCT PE_BABY_INVOICE_DATE FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_BABY_INVOICE_DATE IS NOT NULL;

-- EB_AMOUNT
SELECT DISTINCT EB_AMOUNT FROM EXPENSE_BABY WHERE EB_AMOUNT IS NOT NULL;
SELECT DISTINCT PE_BABY_AMOUNT FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_BABY_AMOUNT IS NOT NULL;
SELECT DISTINCT EB.EB_AMOUNT,PSF.PE_BABY_AMOUNT FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_BABY EB WHERE EB.EB_AMOUNT=PSF.PE_BABY_AMOUNT;

-- EB_INVOICE_ITEMS
SELECT DISTINCT PE_BABY_INVOICE_ITEMS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_BABY_INVOICE_ITEMS IS NOT NULL;
SELECT DISTINCT EB.EB_INVOICE_ITEMS,PSF.PE_BABY_INVOICE_ITEMS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_BABY EB  WHERE EB.EB_INVOICE_ITEMS=PSF.PE_BABY_INVOICE_ITEMS;

-- EB_INVOICE_FROM
SELECT DISTINCT PE_BABY_INVOICE_FROM FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_BABY_INVOICE_FROM IS NOT NULL;
SELECT DISTINCT PSF.PE_BABY_INVOICE_FROM,EB.EB_INVOICE_FROM FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_BABY EB  WHERE PSF.PE_BABY_INVOICE_FROM=EB.EB_INVOICE_FROM; 

-- EB_COMMENTS
SELECT DISTINCT EB_COMMENTS FROM EXPENSE_BABY WHERE EB_COMMENTS IS NOT NULL;
SELECT DISTINCT PE_BABY_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='BABY' AND PE_BABY_COMMENTS IS NOT NULL;
SELECT DISTINCT PSF.PE_BABY_COMMENTS,EB.EB_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF,EXPENSE_BABY EB WHERE PSF.PE_BABY_COMMENTS=EB.EB_COMMENTS AND PE_TYPE_OF_EXPENSE='BABY';

-- ULD_ID
SELECT DISTINCT ULD_ID FROM EXPENSE_BABY;
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN EXPENSE_BABY C ON B.ULD_ID=C.ULD_ID;

-- TIMESTAMP
SELECT DISTINCT EB_TIMESTAMP FROM EXPENSE_BABY;
SELECT DISTINCT TIMESTAMP FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='BABY';
SELECT DISTINCT SUBTIME(PSF.TIMESTAMP,'08:00:00'),EB.EB_TIMESTAMP FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF,EXPENSE_BABY EB WHERE SUBTIME(PSF.TIMESTAMP,'08:00:00')=EB.EB_TIMESTAMP AND PE_TYPE_OF_EXPENSE='BABY';

-- EXPENSE_CAR 
SELECT *FROM EXPENSE_CAR;
SELECT * FROM SOURCE_04062014. PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='CAR EXPENSE';

-- ECN_ID
SELECT DISTINCT PPE.PE_CAR_EXP_TYPE ,EC.ECN_DATA ,EC.ECN_ID , ECA.ECN_ID FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PPE
INNER JOIN EXPENSE_CONFIGURATION EC ON PPE.PE_CAR_EXP_TYPE =EC.ECN_DATA INNER JOIN EXPENSE_CAR ECA ON EC.ECN_ID = ECA.ECN_ID WHERE PPE.PE_TYPE_OF_EXPENSE ='CAR EXPENSE';

-- INVOICE_DATE
SELECT DISTINCT EC_INVOICE_DATE FROM EXPENSE_CAR WHERE EC_INVOICE_DATE IS NOT NULL;
SELECT DISTINCT PE_CAR_EXP_INVOICE_DATE FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_CAR_EXP_INVOICE_DATE IS NOT NULL;
SELECT DISTINCT  PSF.PE_CAR_EXP_INVOICE_DATE ,EC.EC_INVOICE_DATE  FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR EC  WHERE PSF.PE_CAR_EXP_INVOICE_DATE =EC.EC_INVOICE_DATE;

-- EC_AMOUNT
SELECT DISTINCT  PSF.PE_CAR_EXP_AMOUNT ,EC.EC_AMOUNT FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR EC  WHERE PSF.PE_CAR_EXP_AMOUNT = EC.EC_AMOUNT;

-- INVOICE_ITEM
SELECT DISTINCT  PSF.PE_CAR_EXP_INVOICE_ITEMS ,EC.EC_INVOICE_ITEMS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR EC  WHERE PSF.PE_CAR_EXP_INVOICE_ITEMS =EC.EC_INVOICE_ITEMS;

-- INVOICE FROM
SELECT DISTINCT  PSF.PE_CAR_EXP_INVOICE_FROM ,EC.EC_INVOICE_FROM FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR EC  WHERE PSF.PE_CAR_EXP_INVOICE_FROM =EC.EC_INVOICE_FROM; 

-- EC_COMMENTS
SELECT DISTINCT EC_COMMENTS FROM EXPENSE_CAR WHERE EC_COMMENTS IS NOT NULL;
SELECT DISTINCT PE_CAR_EXP_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_CAR_EXP_COMMENTS IS NOT NULL; 
SELECT DISTINCT PSF.PE_CAR_EXP_COMMENTS,EC.EC_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT  PSF,EXPENSE_CAR EC WHERE PSF.PE_CAR_EXP_COMMENTS=EC.EC_COMMENTS AND PE_TYPE_OF_EXPENSE='CAR EXPENSE';

-- ULD_ID
SELECT DISTINCT ULD_ID FROM EXPENSE_CAR;
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN EXPENSE_CAR C ON B.ULD_ID=C.ULD_ID;

-- TIMESTAMP
SELECT DISTINCT EC_TIMESTAMP FROM EXPENSE_CAR;
SELECT DISTINCT TIMESTAMP FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT  WHERE PE_TYPE_OF_EXPENSE='CAR EXPENSE';
SELECT DISTINCT SUBTIME(PSF.TIMESTAMP,'08:00:00') AS TIMESTAMP,EC.EC_TIMESTAMP FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF,EXPENSE_CAR EC WHERE  SUBTIME(PSF.TIMESTAMP,'08:00:00')=EC.EC_TIMESTAMP AND PE_TYPE_OF_EXPENSE='CAR EXPENSE';

-- EXPENSE CAR LOAN
SELECT*FROM EXPENSE_CAR_LOAN;
SELECT*FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE='CAR LOAN';

-- ECL_PAID DATE
SELECT DISTINCT ECL_PAID_DATE FROM EXPENSE_CAR_LOAN WHERE ECL_PAID_DATE IS NOT NULL;
SELECT DISTINCT PE_CARLOAN_PAID_DATE FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_CARLOAN_PAID_DATE IS NOT NULL;
SELECT DISTINCT  PSF.PE_CARLOAN_PAID_DATE ,ECL.ECL_PAID_DATE FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR_LOAN ECL  WHERE PSF.PE_CARLOAN_PAID_DATE =ECL.ECL_PAID_DATE ;

-- ECL_FROM_PERIOD 
SELECT DISTINCT ECL_FROM_PERIOD FROM EXPENSE_CAR_LOAN WHERE ECL_FROM_PERIOD IS NOT NULL;
SELECT DISTINCT PE_CARLOAN_FROM_PERIOD FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_CARLOAN_FROM_PERIOD IS NOT NULL;
SELECT DISTINCT  PSF.PE_CARLOAN_FROM_PERIOD ,ECL.ECL_FROM_PERIOD FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR_LOAN ECL  WHERE PSF.PE_CARLOAN_FROM_PERIOD=ECL.ECL_FROM_PERIOD;  

-- ECL_TO_PERIOD
SELECT DISTINCT ECL_TO_PERIOD FROM EXPENSE_CAR_LOAN WHERE ECL_TO_PERIOD IS NOT NULL;
SELECT DISTINCT PE_CARLOAN_TO_PERIOD FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE= 'CAR LOAN' AND PE_CARLOAN_TO_PERIOD IS NOT NULL;
SELECT DISTINCT  PSF.PE_CARLOAN_TO_PERIOD ,ECL.ECL_TO_PERIOD FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR_LOAN ECL  WHERE   PSF.PE_CARLOAN_TO_PERIOD =ECL.ECL_TO_PERIOD; 

-- ECL_AMOUNT
SELECT DISTINCT ECL_AMOUNT FROM EXPENSE_CAR_LOAN;
SELECT DISTINCT PE_CARLOAN_AMOUNT FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE= 'CAR LOAN';
SELECT DISTINCT  PSF.PE_CARLOAN_AMOUNT ,ECL.ECL_AMOUNT FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR_LOAN ECL  WHERE   PSF.PE_CARLOAN_AMOUNT =ECL.ECL_AMOUNT; 

-- ECL_COMMENTS
SELECT DISTINCT ECL_COMMENTS FROM EXPENSE_CAR_LOAN WHERE ECL_COMMENTS IS NOT NULL;
SELECT DISTINCT PE_CARLOAN_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE= 'CAR LOAN' AND PE_CARLOAN_COMMENTS IS NOT NULL;
SELECT DISTINCT  PSF.PE_CARLOAN_COMMENTS ,ECL.ECL_COMMENTS FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF, EXPENSE_CAR_LOAN ECL  WHERE   PSF.PE_CARLOAN_COMMENTS =ECL.ECL_COMMENTS; 

-- ULD_ID
SELECT DISTINCT ULD_ID FROM EXPENSE_CAR_LOAN;
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN EXPENSE_CAR_LOAN C ON B.ULD_ID=C.ULD_ID;

-- TIMESTAMP
SELECT DISTINCT ECL_TIMESTAMP FROM EXPENSE_CAR_LOAN;
SELECT DISTINCT TIMESTAMP FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT WHERE PE_TYPE_OF_EXPENSE= 'CAR LOAN';
SELECT DISTINCT SUBTIME(PSF.TIMESTAMP,'08:00:00'),ECL.ECL_TIMESTAMP FROM SOURCE_04062014.PERSONAL_SCDB_FORMAT PSF,EXPENSE_CAR_LOAN ECL WHERE SUBTIME(PSF.TIMESTAMP,'08:00:00')=ECL.ECL_TIMESTAMP AND PSF.PE_TYPE_OF_EXPENSE= 'CAR LOAN';
