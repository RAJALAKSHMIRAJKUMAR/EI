-- EXPENSE_AIRCON SERVICE BY
SELECT EASB_ID FROM EXPENSE_AIRCON_SERVICE_BY WHERE EASB_ID IN(SELECT EDAS_ID FROM EXPENSE_DETAIL_AIRCON_SERVICE);

SELECT DISTINCT EXPD_AIRCON_SERVICED_BY FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_AIRCON_SERVICED_BY IS NOT NULL AND EXPD_AIRCON_SERVICED_BY!='BCS Aircon Engineering';
SELECT DISTINCT EASB_DATA FROM EXPENSE_AIRCON_SERVICE_BY;
SELECT DISTINCT BDSF.EXPD_AIRCON_SERVICED_BY,EASB.EASB_DATA FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF,EXPENSE_AIRCON_SERVICE_BY EASB WHERE BDSF.EXPD_AIRCON_SERVICED_BY=EASB.EASB_DATA;

SELECT DISTINCT ULD_ID FROM EXPENSE_AIRCON_SERVICE_BY;
SELECT DISTINCT ULD_ID FROM EXPENSE_AIRCON_SERVICE_BY WHERE ULD_ID IN (SELECT ULD_ID FROM EXPENSE_DETAIL_AIRCON_SERVICE);

SELECT DISTINCT SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') , DAS.EASB_TIMESTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF, EXPENSE_AIRCON_SERVICE_BY DAS WHERE SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') = DAS.EASB_TIMESTAMP;

-- EXPENSE_DETAIL_STARHUB
SELECT * FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE = 'STAR HUB';
SELECT * FROM EXPENSE_DETAIL_STARHUB;

SELECT S.EXPD_UNIT_NO,U.UNIT_NO,U.UNIT_ID,D.UNIT_ID FROM EXPENSE_DETAIL_STARHUB D,SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT S,UNIT U WHERE S.EXPD_UNIT_NO=U.UNIT_NO AND D.UNIT_ID=U.UNIT_ID AND S.EXPD_TYPE_OF_EXPENSE = 'STAR HUB' ORDER BY U.UNIT_ID;

SELECT ECN_ID FROM EXPENSE_CONFIGURATION WHERE ECN_DATA='CO' AND CGN_ID=27;
SELECT ECN_ID FROM EXPENSE_CONFIGURATION WHERE ECN_DATA='PERSONAL' AND CGN_ID=27;
SELECT  DISTINCT EXPD_INVOICE_TO   FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT   WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB';
SELECT DISTINCT ECN_ID FROM EXPENSE_DETAIL_STARHUB;

SELECT DISTINCT EXPD_STAR_HUB_ACCOUNT_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_STAR_HUB_ACCOUNT_NO IS NOT NULL;
SELECT DISTINCT EDSH_ACCOUNT_NO FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_ACCOUNT_NO IS NOT NULL;
SELECT DISTINCT EDSH.EDSH_ACCOUNT_NO,BDSF.EXPD_STAR_HUB_ACCOUNT_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE EDSH.EDSH_ACCOUNT_NO=BDSF.EXPD_STAR_HUB_ACCOUNT_NO AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_APPL_DATE FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_APPL_DATE IS NOT NULL;
SELECT DISTINCT EXPD_APPL_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_APPL_DATE IS NOT NULL;
SELECT DISTINCT EDSH.EDSH_APPL_DATE,BDSF.EXPD_APPL_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE EDSH.EDSH_APPL_DATE=BDSF.EXPD_APPL_DATE AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_CABLE_START_DATE FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_CABLE_START_DATE IS NOT NULL;
SELECT DISTINCT EXPD_CABLE_START_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_CABLE_START_DATE IS NOT NULL;
SELECT DISTINCT EDSH.EDSH_CABLE_START_DATE,BDSF.EXPD_CABLE_START_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE EDSH.EDSH_CABLE_START_DATE=BDSF.EXPD_CABLE_START_DATE AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_CABLE_END_DATE FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_CABLE_END_DATE IS NOT NULL;
SELECT DISTINCT EXPD_CABLE_END_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_CABLE_END_DATE IS NOT NULL;
SELECT DISTINCT EDSH.EDSH_CABLE_END_DATE ,BDSF.EXPD_CABLE_END_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE EDSH.EDSH_CABLE_END_DATE=BDSF.EXPD_CABLE_END_DATE AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_INTERNET_START_DATE FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_INTERNET_START_DATE IS NOT NULL;
SELECT DISTINCT EXPD_INTERNET_START_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_INTERNET_START_DATE IS NOT NULL;
SELECT DISTINCT EDSH.EDSH_INTERNET_START_DATE,BDSF.EXPD_INTERNET_START_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE EDSH.EDSH_INTERNET_START_DATE=BDSF.EXPD_INTERNET_START_DATE AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_INTERNET_END_DATE FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_INTERNET_END_DATE IS NOT NULL;
SELECT DISTINCT EXPD_INTERNET_END_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_INTERNET_END_DATE IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_INTERNET_END_DATE , EDSH.EDSH_INTERNET_END_DATE FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE BDSF.EXPD_INTERNET_END_DATE= EDSH.EDSH_INTERNET_END_DATE AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_SSID FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_SSID IS NOT NULL;
SELECT DISTINCT EXPD_SSID FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_SSID IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_SSID,EDSH_SSID FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH  WHERE BDSF.EXPD_SSID=EDSH_SSID AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_PWD FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_PWD IS NOT NULL;
SELECT DISTINCT EXPD_PWD FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_PWD IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_PWD,EDSH_PWD FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH  WHERE BDSF.EXPD_PWD=EDSH_PWD AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB'; 

SELECT DISTINCT EDSH_CABLE_BOX_SERIAL_NO FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_CABLE_BOX_SERIAL_NO IS NOT NULL;
SELECT DISTINCT EXPD_CABLE_BOX_SERIAL_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_CABLE_BOX_SERIAL_NO IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_CABLE_BOX_SERIAL_NO , EDSH.EDSH_CABLE_BOX_SERIAL_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE BDSF.EXPD_CABLE_BOX_SERIAL_NO = EDSH.EDSH_CABLE_BOX_SERIAL_NO AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_MODEM_SERIAL_NO FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_MODEM_SERIAL_NO IS NOT NULL;
SELECT DISTINCT EXPD_MODEM_SERIAL_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_MODEM_SERIAL_NO IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_MODEM_SERIAL_NO , EDSH.EDSH_MODEM_SERIAL_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE BDSF.EXPD_MODEM_SERIAL_NO= EDSH.EDSH_MODEM_SERIAL_NO AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_BASIC_GROUP FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_BASIC_GROUP IS NOT NULL;
SELECT DISTINCT EXPD_BASIC_GROUP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND  EXPD_BASIC_GROUP IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_BASIC_GROUP,EDSH_BASIC_GROUP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF,EXPENSE_DETAIL_STARHUB WHERE BDSF.EXPD_BASIC_GROUP=EDSH_BASIC_GROUP AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_ADDTNL_CH FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_ADDTNL_CH IS NOT NULL;
SELECT DISTINCT EXPD_ADDTNL_CH FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_ADDTNL_CH IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_ADDTNL_CH , EDSH.EDSH_ADDTNL_CH FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE BDSF.EXPD_ADDTNL_CH = EDSH.EDSH_ADDTNL_CH AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_COMMENTS FROM EXPENSE_DETAIL_STARHUB WHERE EDSH_COMMENTS IS NOT NULL;
SELECT DISTINCT EXPD_COMMENTS FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB' AND EXPD_COMMENTS IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_COMMENTS , EDSH.EDSH_COMMENTS FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE BDSF.EXPD_COMMENTS = EDSH.EDSH_COMMENTS AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT EDSH_TIMESTAMP FROM EXPENSE_DETAIL_STARHUB;
SELECT DISTINCT `TIMESTAMP` FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB';
SELECT DISTINCT SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') , EDSH.EDSH_TIMESTAMP , BDSF.EXPD_REC_VER , EDSH.EDSH_REC_VER FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_STARHUB EDSH WHERE (SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') = EDSH.EDSH_TIMESTAMP )AND BDSF.EXPD_TYPE_OF_EXPENSE ='STAR HUB';

SELECT DISTINCT ULD_ID FROM EXPENSE_DETAIL_STARHUB;
SELECT DISTINCT USERSTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='STAR HUB';
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN EXPENSE_DETAIL_STARHUB C ON B.ULD_ID=C.ULD_ID;

-- EXPENSE_DETAIL_ELECTRICITY
SELECT * FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='ELECTRICITY';
SELECT *FROM EXPENSE_DETAIL_ELECTRICITY;

SELECT DISTINCT UNIT_ID FROM EXPENSE_DETAIL_ELECTRICITY;
SELECT DISTINCT EDE.UNIT_ID,BDSF.EXPD_UNIT_NO,U.UNIT_ID,U.UNIT_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF INNER JOIN UNIT U ON BDSF.EXPD_UNIT_NO=U.UNIT_NO INNER JOIN EXPENSE_DETAIL_ELECTRICITY EDE ON U.UNIT_ID = EDE.UNIT_ID ORDER BY U.UNIT_ID;

SELECT ECN_ID FROM EXPENSE_CONFIGURATION WHERE ECN_DATA='CO' AND CGN_ID=27;
SELECT ECN_ID FROM EXPENSE_CONFIGURATION WHERE ECN_DATA='PERSONAL' AND CGN_ID=27;
SELECT ECN_ID FROM EXPENSE_CONFIGURATION WHERE ECN_DATA='OPAL PARTNERS ASIA' AND CGN_ID=27;
SELECT  DISTINCT EXPD_INVOICE_TO   FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT   WHERE EXPD_TYPE_OF_EXPENSE='ELECTRICITY';
SELECT DISTINCT ECN_ID FROM EXPENSE_DETAIL_ELECTRICITY;

SELECT DISTINCT EDE_COMMENTS FROM EXPENSE_DETAIL_ELECTRICITY WHERE EDE_COMMENTS IS NOT NULL;
SELECT DISTINCT EXPD_COMMENTS FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='ELECTRICITY' AND EXPD_COMMENTS IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_COMMENTS,EDE.EDE_COMMENTS FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF,EXPENSE_DETAIL_ELECTRICITY EDE WHERE BDSF.EXPD_COMMENTS=EDE.EDE_COMMENTS AND EXPD_TYPE_OF_EXPENSE='ELECTRICITY';

SELECT DISTINCT ULD_ID FROM EXPENSE_DETAIL_ELECTRICITY;
SELECT DISTINCT USERSTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='ELECTRICITY';
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN EXPENSE_DETAIL_ELECTRICITY C ON B.ULD_ID=C.ULD_ID;

SELECT DISTINCT SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') , EDE.EDE_TIMESTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF , EXPENSE_DETAIL_ELECTRICITY EDE WHERE (SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') = EDE.EDE_TIMESTAMP  )AND BDSF.EXPD_TYPE_OF_EXPENSE ='ELECTRICITY';

-- EXPENSE_DETAIL_DIGITAL_VOICE
SELECT * FROM EXPENSE_DETAIL_DIGITAL_VOICE;
SELECT * FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE';

SELECT DISTINCT UNIT_ID FROM EXPENSE_DETAIL_DIGITAL_VOICE;
SELECT DISTINCT EDDV.UNIT_ID,BDSF.EXPD_UNIT_NO,U.UNIT_ID,U.UNIT_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF INNER JOIN UNIT U ON BDSF.EXPD_UNIT_NO=U.UNIT_NO INNER JOIN EXPENSE_DETAIL_DIGITAL_VOICE EDDV ON U.UNIT_ID = EDDV.UNIT_ID; 

SELECT DISTINCT ECN_ID FROM EXPENSE_DETAIL_DIGITAL_VOICE;
SELECT DISTINCT EXPD_INVOICE_TO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE' AND EXPD_INVOICE_TO IS NOT NULL;
SELECT ECN_ID FROM EXPENSE_CONFIGURATION WHERE ECN_DATA='PERSONAL' AND CGN_ID=27;

SELECT DISTINCT EDDV_DIGITAL_VOICE_NO FROM EXPENSE_DETAIL_DIGITAL_VOICE WHERE EDDV_DIGITAL_VOICE_NO IS NOT NULL;
SELECT DISTINCT EXPD_DIGITAL_VOICE_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE' AND EXPD_DIGITAL_VOICE_NO IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_DIGITAL_VOICE_NO,EDDV.EDDV_DIGITAL_VOICE_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF,EXPENSE_DETAIL_DIGITAL_VOICE EDDV WHERE BDSF.EXPD_DIGITAL_VOICE_NO=EDDV.EDDV_DIGITAL_VOICE_NO AND EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE';

SELECT DISTINCT EDDV_DIGITAL_ACCOUNT_NO FROM EXPENSE_DETAIL_DIGITAL_VOICE WHERE EDDV_DIGITAL_ACCOUNT_NO IS NOT NULL;
SELECT DISTINCT EXPD_DIGITAL_ACCOUNT_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE' AND EXPD_DIGITAL_ACCOUNT_NO IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_DIGITAL_ACCOUNT_NO,EDDV.EDDV_DIGITAL_ACCOUNT_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF,EXPENSE_DETAIL_DIGITAL_VOICE EDDV WHERE BDSF.EXPD_DIGITAL_ACCOUNT_NO=EDDV.EDDV_DIGITAL_ACCOUNT_NO AND EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE';

SELECT DISTINCT EDDV_COMMENTS FROM EXPENSE_DETAIL_DIGITAL_VOICE WHERE EDDV_COMMENTS IS NOT NULL;
SELECT DISTINCT EXPD_COMMENTS FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE' AND EXPD_COMMENTS IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_COMMENTS,EDDV.EDDV_COMMENTS FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF,EXPENSE_DETAIL_DIGITAL_VOICE EDDV WHERE BDSF.EXPD_COMMENTS=EDDV.EDDV_COMMENTS AND EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE';

SELECT DISTINCT  EDDV_TIMESTAMP FROM EXPENSE_DETAIL_DIGITAL_VOICE;
SELECT DISTINCT TIMESTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE';
SELECT DISTINCT SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') ,EDDV.EDDV_TIMESTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF, EXPENSE_DETAIL_DIGITAL_VOICE EDDV WHERE SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') = EDDV.EDDV_TIMESTAMP;

SELECT DISTINCT ULD_ID FROM EXPENSE_DETAIL_DIGITAL_VOICE;
SELECT DISTINCT USERSTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='DIGITAL VOICE';
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN EXPENSE_DETAIL_DIGITAL_VOICE C ON B.ULD_ID=C.ULD_ID;

-- EXPENSE_DETAIL_AIRCON_SERVICE
SELECT * FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='AIRCON SERVICES';
SELECT * FROM EXPENSE_DETAIL_AIRCON_SERVICE;

SELECT DISTINCT UNIT_ID FROM EXPENSE_DETAIL_AIRCON_SERVICE;
SELECT DISTINCT BDSF.EXPD_UNIT_NO,U.UNIT_NO,U.UNIT_ID,EDAS.UNIT_ID FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF INNER JOIN UNIT U ON BDSF.EXPD_UNIT_NO=U.UNIT_NO INNER JOIN EXPENSE_DETAIL_AIRCON_SERVICE EDAS ON U.UNIT_ID = EDAS.UNIT_ID ORDER BY U.UNIT_ID;

SELECT DISTINCT EASB_ID FROM EXPENSE_DETAIL_AIRCON_SERVICE;
SELECT DISTINCT EASB_ID FROM EXPENSE_AIRCON_SERVICE_BY;

SELECT DISTINCT EDAS_COMMENTS FROM EXPENSE_DETAIL_AIRCON_SERVICE WHERE EDAS_COMMENTS IS NOT NULL;
SELECT DISTINCT EXPD_COMMENTS FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='AIRCON SERVICES' AND EXPD_COMMENTS IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_COMMENTS,EDAS.EDAS_COMMENTS FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF,EXPENSE_DETAIL_AIRCON_SERVICE EDAS WHERE BDSF.EXPD_COMMENTS=EDAS.EDAS_COMMENTS AND EXPD_TYPE_OF_EXPENSE='AIRCON SERVICES';

SELECT DISTINCT ULD_ID FROM EXPENSE_DETAIL_AIRCON_SERVICE;
SELECT DISTINCT USERSTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='AIRCON SERVICES';
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN EXPENSE_DETAIL_AIRCON_SERVICE C ON B.ULD_ID=C.ULD_ID;

SELECT DISTINCT  EDAS_TIMESTAMP FROM EXPENSE_DETAIL_AIRCON_SERVICE;
SELECT DISTINCT TIMESTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='AIRCON SERVICES';
SELECT DISTINCT SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') , DAS.EDAS_TIMESTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF, EXPENSE_DETAIL_AIRCON_SERVICE DAS WHERE SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') = DAS.EDAS_TIMESTAMP;

-- EXPENSE_DETAIL_CARPARK
SELECT * FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='CAR PARK';
SELECT * FROM EXPENSE_DETAIL_CARPARK;

SELECT DISTINCT UNIT_ID FROM EXPENSE_DETAIL_CARPARK;
SELECT DISTINCT EDC.UNIT_ID,U.UNIT_ID,BDSF.EXPD_UNIT_NO,U.UNIT_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF INNER JOIN UNIT U ON BDSF.EXPD_UNIT_NO=U.UNIT_NO INNER JOIN EXPENSE_DETAIL_CARPARK EDC ON U.UNIT_ID = EDC.UNIT_ID GROUP BY EDC.EDCP_ID;

SELECT DISTINCT EDCP_CAR_NO FROM EXPENSE_DETAIL_CARPARK WHERE EDCP_CAR_NO IS NOT NULL;
SELECT DISTINCT EXPD_CAR_NO FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='CAR PARK' AND EXPD_CAR_NO IS NOT NULL;
SELECT DISTINCT BDSF.EXPD_CAR_NO,EDCP.EDCP_CAR_NO FROM  SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF,EXPENSE_DETAIL_CARPARK EDCP WHERE BDSF.EXPD_CAR_NO=EDCP.EDCP_CAR_NO AND EXPD_TYPE_OF_EXPENSE='CAR PARK';

SELECT DISTINCT ULD_ID FROM EXPENSE_DETAIL_CARPARK;
SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT A INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID INNER JOIN EXPENSE_DETAIL_CARPARK C ON B.ULD_ID=C.ULD_ID;

SELECT DISTINCT TIMESTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT WHERE EXPD_TYPE_OF_EXPENSE='CAR PARK';
SELECT  DISTINCT SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') , EC.EDCP_TIMESTAMP FROM SOURCE_17072014.BIZ_DETAIL_SCDB_FORMAT BDSF, EXPENSE_DETAIL_CARPARK EC WHERE EXPD_TYPE_OF_EXPENSE='CAR PARK' AND SUBTIME( BDSF.`TIMESTAMP`,'08:00:00') = EC.EDCP_TIMESTAMP;