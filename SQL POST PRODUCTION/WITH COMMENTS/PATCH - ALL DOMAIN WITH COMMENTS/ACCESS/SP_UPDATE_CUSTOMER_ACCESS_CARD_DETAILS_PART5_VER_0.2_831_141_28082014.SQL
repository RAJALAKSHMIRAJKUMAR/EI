-- version:0.2 --sdate:27/08/2014 --edate:27/08/2014 --issue:831 --desc:added output parameter in subsp's --comment no#141 --Done By:RL
-- VER:0.1 --SDATE:08/08/2014 --EDATE:08/08/2014 --ISSUE:831 --DESC:MODIFIED THE PATCH AND SPLITTED FROM MAIN SP. DONE BY: RAJA
DROP PROCEDURE IF EXISTS SP_UPDATE_CUSTOMER_ACCESS_CARD_DETAILS_PART5;
CREATE PROCEDURE SP_UPDATE_CUSTOMER_ACCESS_CARD_DETAILS_PART5(
IN USERSTAMP VARCHAR(50))
BEGIN
	DECLARE OLDVALUE_ACCESS_TICKLER TEXT;
	DECLARE NEWVALUE_ACCESS_TICKLER TEXT;
	DECLARE OLD_UASDID INTEGER;
	DECLARE NEW_UASDID INTEGER;
	SET FOREIGN_KEY_CHECKS = 0;
-- CUSTOMER_ID = 411
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(411,9,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 26,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 9;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(411,9,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,411,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 159
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(159,452,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = (SELECT UASD_ID FROM UNIT_ACCESS_STAMP_DETAILS WHERE UASD_ACCESS_CARD = 2222222),CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 452;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(159,452,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,159,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 425	
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(425,66,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 267 ,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 66;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(425,66,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,425,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 433	
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(433,333,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 196 ,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 333;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(433,333,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,433,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;	
-- CUSTOMER_ID = 417	
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(417,51,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 109 ,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 51;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(417,51,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,417,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;	
-- CUSTOMER_ID = 420	
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(420,149,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = (SELECT UASD_ID FROM UNIT_ACCESS_STAMP_DETAILS WHERE UASD_ACCESS_CARD = 3333333) ,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 149;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(420,149,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,420,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;	
-- CUSTOMER_ID = 462
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(462,79,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 203,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 79;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(462,79,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,462,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 462
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(462,559,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 197,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 559;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(462,559,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,462,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 468
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(468,689,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 114 ,CACD_TIMESTAMP = CACD_TIMESTAMP WHERE CACD_ID = 689;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(468,689,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,468,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 476
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(476,43,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 100 ,CACD_TIMESTAMP = CACD_TIMESTAMP WHERE CACD_ID = 43;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(476,43,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,476,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 479
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(479,501,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 145,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 501;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(479,501,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,479,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 221
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(221,360,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = (SELECT UASD_ID FROM UNIT_ACCESS_STAMP_DETAILS WHERE UASD_ACCESS_CARD=4444444),CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 360;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(221,360,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,221,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 458
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(458,329,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 119,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 329;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(458,329,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,458,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
-- CUSTOMER_ID = 490
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_OLDVALUE(490,560,USERSTAMP,@OLDVALUE_ACCESS,@OLDUASDID);
		SET OLDVALUE_ACCESS_TICKLER = @OLDVALUE_ACCESS;
		SET OLD_UASDID = @OLDUASDID;
		UPDATE CUSTOMER_ACCESS_CARD_DETAILS SET UASD_ID = 126,CACD_TIMESTAMP=CACD_TIMESTAMP WHERE CACD_ID = 560;
		CALL SP_ACCESS_CARD_TICKLER_HISTORY_NEWVALUE(490,560,USERSTAMP,@NEWVALUE_ACCESS,@NEWUASDID);
		SET NEWVALUE_ACCESS_TICKLER=@NEWVALUE_ACCESS;
		SET NEW_UASDID = @NEWUASDID;
		IF(OLD_UASDID != NEW_UASDID)THEN
			INSERT INTO TICKLER_HISTORY(TP_ID,CUSTOMER_ID,TTIP_ID,TH_OLD_VALUE,TH_NEW_VALUE,ULD_ID)VALUES
			(1,490,13,OLDVALUE_ACCESS_TICKLER, NEWVALUE_ACCESS_TICKLER ,(SELECT ULD_ID FROM USER_LOGIN_DETAILS WHERE ULD_LOGINID=USERSTAMP));
		END IF;
END;	
	