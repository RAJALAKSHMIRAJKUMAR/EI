-- VERSION 0.2 STARTDATE:05/08/2014 ENDDATE:05/08/2014 ISSUE NO: 836 DESC:GETTING ERROR MESSAGE FROM CONFIG TABLE. DONE BY :SASIKALA COMMENT NO#836
-- VERSION 0.1 STARTDATE:11/07/2014 ENDDATE:11/07/2014 ISSUE NO: 593 DESC:THROWING ERROR MSG FOR THE CHECK CONSTRAINS. DONE BY :RL COMMENT NO#257

DROP PROCEDURE IF EXISTS SP_TRG_UNIT_LOGIN_DETAILS_VALIDATION;
CREATE PROCEDURE SP_TRG_UNIT_LOGIN_DETAILS_VALIDATION(
IN DOORCODE VARCHAR(10),
IN WEBLOGIN VARCHAR(13),
IN PROCESS TEXT)
BEGIN
	DECLARE MESSAGE_TEXT VARCHAR(50);
	DECLARE ERRORMSG TEXT;
	IF(PROCESS = 'INSERT') OR (PROCESS = 'UPDATE')THEN
		IF(DOORCODE IS NOT NULL)THEN
			IF(LENGTH(DOORCODE)<6) THEN
        SET ERRORMSG=(SELECT EMC_DATA FROM ERROR_MESSAGE_CONFIGURATION WHERE EMC_ID=467);
				SIGNAL SQLSTATE '45000'
				SET MESSAGE_TEXT= ERRORMSG; 
			END IF;
		END IF;
		IF(WEBLOGIN IS NOT NULL)THEN
			IF(LENGTH(WEBLOGIN)<5) THEN
        SET ERRORMSG=(SELECT EMC_DATA FROM ERROR_MESSAGE_CONFIGURATION WHERE EMC_ID=466);
				SIGNAL SQLSTATE '45000'
				SET MESSAGE_TEXT= ERRORMSG; 
			END IF;
		END IF;
	END IF;
END;