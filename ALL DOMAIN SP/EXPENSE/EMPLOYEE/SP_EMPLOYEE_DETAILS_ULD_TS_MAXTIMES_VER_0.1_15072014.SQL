--version 0.1 --sdate:15/07/2014 --edate:15/07/2014 --issueno:535 COMMENT:#316 --desc:SP FOR UPDATING NOOFTIMES HEADER IN EMPLOYEE_DETAILS  --done by BHAVANI.R
DROP PROCEDURE IF EXISTS SP_EMPLOYEE_DETAILS_ULD_TS_MAXTIMES;
CREATE PROCEDURE SP_EMPLOYEE_DETAILS_ULD_TS_MAXTIMES(IN EMPID INTEGER,IN USER_ULDID INTEGER)
BEGIN
-- DECLARING VARIABLES
	DECLARE ULDTSMAXTIMES INTEGER;
	DECLARE EXIT HANDLER FOR SQLEXCEPTION
	BEGIN
		ROLLBACK;
	END;
	SET ULDTSMAXTIMES = (SELECT ULD_TS_MAXTIMES FROM EMPLOYEE_DETAILS WHERE EMP_ID = EMPID);
-- UPDATE NOOFTIMES HEADER BY INCREMNTING THE VALUE BY 1
	UPDATE EMPLOYEE_DETAILS SET ULD_TS_MAXTIMES = (ULDTSMAXTIMES+1),ULD_ID = USER_ULDID WHERE EMP_ID = EMPID;
	COMMIT;
END;