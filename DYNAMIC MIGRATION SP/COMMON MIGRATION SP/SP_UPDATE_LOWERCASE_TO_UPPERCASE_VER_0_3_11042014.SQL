-- version:0.3 --sadte:11/04/2014 --edate:11/04/2014 --issue:803 --desc:added call query --done by:RL

-- version:0.2 --sadte:29/03/2014 --edate:29/03/2014 --issue:747 --comment no#43 --desc:get source to destination dynamically --done by:RL
--version:0.1 --sdate:07/02/2014 --edate:07/02/2014 --issue:740 --desc:changed lower case data's to uppercase --doneby:rl
DROP PROCEDURE IF EXISTS SP_UPDATE_LOWERCASE_TO_UPPERCASE;
CREATE PROCEDURE SP_UPDATE_LOWERCASE_TO_UPPERCASE(IN DESTINATIONSCHEMA VARCHAR(50))
BEGIN

--UNIT_ROOM_TYPE_DETAILS
	SET @UPDATEURTD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.UNIT_ROOM_TYPE_DETAILS SET URTD_ROOM_TYPE = UCASE(URTD_ROOM_TYPE)'));
	PREPARE UPDATEURTDSTMT FROM @UPDATEURTD;
	EXECUTE UPDATEURTDSTMT;
	
--UNIT_STAMP_DUTY_TYPE
	SET @UPDATEUSDT = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.UNIT_STAMP_DUTY_TYPE SET USDT_DATA = UCASE(USDT_DATA)'));
	PREPARE UPDATEUSDTSTMT FROM @UPDATEUSDT;
	EXECUTE UPDATEUSDTSTMT;
	
--UNIT_LOGIN_DETAILS
	SET @UPDATEULD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.UNIT_LOGIN_DETAILS SET ULDTL_WEBLOGIN = UCASE(ULDTL_WEBLOGIN)'));
	PREPARE UPDATEULDSTMT FROM @UPDATEULD;
	EXECUTE UPDATEULDSTMT;
	
--UNIT_ACCOUNT_DETAILS
	SET @UPDATEUACD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.UNIT_ACCOUNT_DETAILS SET UACD_ACC_NAME = UCASE(UACD_ACC_NAME) , UACD_BANK_ADDRESS = UCASE(UACD_BANK_ADDRESS)'));
	PREPARE UPDATEUACDSTMT FROM @UPDATEUACD;
	EXECUTE UPDATEUACDSTMT;
	
--CUSTOMER
	SET @UPDATECUSTOMER = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER SET CUSTOMER_FIRST_NAME = UCASE(CUSTOMER_FIRST_NAME) , CUSTOMER_LAST_NAME = UCASE(CUSTOMER_LAST_NAME)'));
	PREPARE UPDATECUSTOMERSTMT FROM @UPDATEUACD;
	EXECUTE UPDATECUSTOMERSTMT;

--CUSTOMER_COMPANY_DETAILS
	SET @UPDATECCD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_COMPANY_DETAILS SET CCD_COMPANY_NAME = UCASE(CCD_COMPANY_NAME) , CCD_COMPANY_ADDR = UCASE(CCD_COMPANY_ADDR)'));
	PREPARE UPDATECCDSTMT FROM @UPDATECCD;
	EXECUTE UPDATECCDSTMT;
	
--CUSTOMER_PERSONAL_DETAILS
	SET @UPDATECPD = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CUSTOMER_PERSONAL_DETAILS SET CPD_EP_NO = UCASE(CPD_EP_NO) , CPD_PASSPORT_NO = UCASE(CPD_PASSPORT_NO)'));
	PREPARE UPDATECPDSTMT FROM @UPDATECPD;
	EXECUTE UPDATECPDSTMT;
	
--EXPENSE_AIRCON_SERVICE_BY
	SET @UPDATEEASB = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_AIRCON_SERVICE_BY SET EASB_DATA = UCASE(EASB_DATA)'));
	PREPARE UPDATEEASBSTMT FROM @UPDATEEASB;
	EXECUTE UPDATEEASBSTMT;
	
--EXPENSE_DETAIL_STARHUB
	SET @UPDATEEDSH = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DETAIL_STARHUB SET EDSH_ACCOUNT_NO = UCASE(EDSH_ACCOUNT_NO) , EDSH_CABLE_BOX_SERIAL_NO = UCASE(EDSH_CABLE_BOX_SERIAL_NO) ,EDSH_MODEM_SERIAL_NO = UCASE(EDSH_MODEM_SERIAL_NO)'));
	PREPARE UPDATEEDSHSTMT FROM @UPDATEEDSH;
	EXECUTE UPDATEEDSHSTMT;
	
--EXPENSE_DETAIL_DIGITAL_VOICE
	SET @UPDATEEDDV = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DETAIL_DIGITAL_VOICE SET EDDV_DIGITAL_ACCOUNT_NO = UCASE(EDDV_DIGITAL_ACCOUNT_NO)'));
	PREPARE UPDATEEDDVSTMT FROM @UPDATEEDDV;
	EXECUTE UPDATEEDDVSTMT;
	
--EXPENSE_DETAIL_CARPARK
	SET @UPDATEEDCP = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_DETAIL_CARPARK SET EDCP_CAR_NO = UCASE(EDCP_CAR_NO)'));
	PREPARE UPDATEEDCPSTMT FROM @UPDATEEDCP;
	EXECUTE UPDATEEDCPSTMT;

--EXPENSE_UNIT
	SET @UPDATEUNIT = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_UNIT SET EU_INVOICE_FROM = UCASE(EU_INVOICE_FROM)'));
	PREPARE UPDATEUNITSTMT FROM @UPDATEUNIT;
	EXECUTE UPDATEUNITSTMT;
	
--EXPENSE_PERSONAL
	SET @UPDATEPERSONAL = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_PERSONAL SET EP_INVOICE_FROM = UCASE(EP_INVOICE_FROM)'));
	PREPARE UPDATEPERSONALSTMT FROM @UPDATEPERSONAL;
	EXECUTE UPDATEPERSONALSTMT;

--EXPENSE_CAR
	SET @UPDATEEXPCAR = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_CAR SET EC_INVOICE_FROM = UCASE(EC_INVOICE_FROM)'));
	PREPARE UPDATEEXPCARSTMT FROM @UPDATEEXPCAR;
	EXECUTE UPDATEEXPCARSTMT;
	
--EXPENSE_BABY
	SET @UPDATEBABY = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EXPENSE_BABY SET EB_INVOICE_FROM = UCASE(EB_INVOICE_FROM)'));
	PREPARE UPDATEBABYSTMT FROM @UPDATEBABY;
	EXECUTE UPDATEBABYSTMT;
	
--BANK_TRANSFER
	SET @UPDATEBANKTRANSFER = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.BANK_TRANSFER SET BT_BANK_ADDRESS = UCASE(BT_BANK_ADDRESS) , BT_CUST_REF = UCASE(BT_CUST_REF) , BT_ACC_NAME = UCASE(BT_ACC_NAME)'));
	PREPARE UPDATEBANKTRANSFERSTMT FROM @UPDATEBANKTRANSFER;
	EXECUTE UPDATEBANKTRANSFERSTMT;
	
--BANK_TRANSFER_MODELS
	SET @UPDATEBANKTRANSFERMODEL = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.BANK_TRANSFER_MODELS SET BTM_DATA = UCASE(BTM_DATA)'));
	PREPARE UPDATEBANKTRANSFERMODELSTMT FROM @UPDATEBANKTRANSFERMODEL;
	EXECUTE UPDATEBANKTRANSFERMODELSTMT;

--CHEQUE_ENTRY_DETAILS
	SET @UPDATECHEQUE = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.CHEQUE_ENTRY_DETAILS SET CHEQUE_TO = UCASE(CHEQUE_TO) , CHEQUE_FOR = UCASE(CHEQUE_FOR)'));
	PREPARE UPDATECHEQUESTMT FROM @UPDATECHEQUE;
	EXECUTE UPDATECHEQUESTMT;
	
--ERM_ENTRY_DETAILS 
	SET @UPDATEERM = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.ERM_ENTRY_DETAILS SET ERM_CUST_NAME  = UCASE(ERM_CUST_NAME )'));
	PREPARE UPDATEERMSTMT FROM @UPDATEERM;
	EXECUTE UPDATEERMSTMT;
	
--EMPLOYEE_DETAILS
	SET @UPDATEEMPDTL = (SELECT CONCAT('UPDATE ',DESTINATIONSCHEMA,'.EMPLOYEE_DETAILS SET EMP_FIRST_NAME = UCASE(EMP_FIRST_NAME) , EMP_LAST_NAME = UCASE(EMP_LAST_NAME)'));
	PREPARE UPDATEEMPDTLSTMT FROM @UPDATEEMPDTL;
	EXECUTE UPDATEEMPDTLSTMT;
END;

CALL SP_UPDATE_LOWERCASE_TO_UPPERCASE(DESTINATIONSCHEMA);