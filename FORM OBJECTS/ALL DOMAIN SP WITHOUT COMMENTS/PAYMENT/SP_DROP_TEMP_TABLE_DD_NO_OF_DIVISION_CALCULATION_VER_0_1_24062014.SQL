DROP PROCEDURE IF EXISTS SP_DROP_TEMP_TABLE_DD_NO_OF_DIVISION_CALCULATION;
CREATE PROCEDURE SP_DROP_TEMP_TABLE_DD_NO_OF_DIVISION_CALCULATION(
IN TEMP_DD_ACTIVE_CUSTOMER_TBLE TEXT,
IN DD_TEMP_TBLNAME_FUTURE_TBLE TEXT,
IN DD_TEMP_TBLNAME_PAYMENT_TRANS_TBLE TEXT,
IN DD_TEMP_TBLNAME_FUTURETRANS_TBLE TEXT,
IN DD_TEMP_TBLNAME_FUTURE_NONTRANSACTION TEXT,
IN DD_TEMP_TABLENAME_FUTURE_NONTRANS_PAYMENT TEXT,
IN DD_TEMP_TBLNAME_UNIT_EXPENSE TEXT,
IN DD_TEMP_TABLENAME_DD_SPLITEDDATE TEXT,
IN DD_TEMP_TABLENAME_CNT_CUSTOMER TEXT)
BEGIN
	DECLARE EXIT HANDLER FOR SQLEXCEPTION
	BEGIN 
		ROLLBACK; 
	END;
	START TRANSACTION;	
	IF(TEMP_DD_ACTIVE_CUSTOMER_TBLE IS NOT NULL)THEN
		SET @DROP_DD_ACTIVE_CUSTOMER=(SELECT CONCAT('DROP TABLE IF EXISTS ',TEMP_DD_ACTIVE_CUSTOMER_TBLE));
		PREPARE DROP_DD_ACTIVE_CUSTOMER_STMT FROM @DROP_DD_ACTIVE_CUSTOMER;
		EXECUTE DROP_DD_ACTIVE_CUSTOMER_STMT;
	END IF;
	IF(DD_TEMP_TBLNAME_FUTURE_TBLE IS NOT NULL)THEN
		SET @DROP_DD_FUTURE_CUSTOMER=(SELECT CONCAT('DROP TABLE IF EXISTS ',DD_TEMP_TBLNAME_FUTURE_TBLE));
		PREPARE DROP_DD_FUTURE_CUSTOMER_STMT FROM @DROP_DD_FUTURE_CUSTOMER;
		EXECUTE DROP_DD_FUTURE_CUSTOMER_STMT;
	END IF;
	IF(DD_TEMP_TBLNAME_PAYMENT_TRANS_TBLE IS NOT NULL)THEN
		SET @DROP_DD_PAYMENT_CHK_TRANSACTION=(SELECT CONCAT('DROP TABLE IF EXISTS ',DD_TEMP_TBLNAME_PAYMENT_TRANS_TBLE));
		PREPARE DROP_DD_PAYMENT_CHK_TRANSACTION_STMT FROM @DROP_DD_PAYMENT_CHK_TRANSACTION;
		EXECUTE DROP_DD_PAYMENT_CHK_TRANSACTION_STMT;
	END IF;
	IF(DD_TEMP_TBLNAME_FUTURETRANS_TBLE IS NOT NULL)THEN
		SET @DROP_DD_EXPENSE_CHK_TRANSACTION=(SELECT CONCAT('DROP TABLE IF EXISTS ',DD_TEMP_TBLNAME_FUTURETRANS_TBLE));
		PREPARE DROP_DD_EXPENSE_CHK_TRANSACTION_STMT FROM @DROP_DD_EXPENSE_CHK_TRANSACTION;
		EXECUTE DROP_DD_EXPENSE_CHK_TRANSACTION_STMT;
	END IF;
	IF(DD_TEMP_TBLNAME_FUTURE_NONTRANSACTION IS NOT NULL)THEN
		SET @DROP_DD_NON_TRANS_FUTURE_CUSTOMER=(SELECT CONCAT('DROP TABLE IF EXISTS ',DD_TEMP_TBLNAME_FUTURE_NONTRANSACTION));
		PREPARE DROP_DD_NON_TRANS_FUTURE_CUSTOMER_STMT FROM @DROP_DD_NON_TRANS_FUTURE_CUSTOMER;
		EXECUTE DROP_DD_NON_TRANS_FUTURE_CUSTOMER_STMT;
	END IF;
	IF(DD_TEMP_TABLENAME_FUTURE_NONTRANS_PAYMENT IS NOT NULL)THEN
		SET @DROP_DD_DELETE_FUTURE_CUSTOMER=(SELECT CONCAT('DROP TABLE IF EXISTS ',DD_TEMP_TABLENAME_FUTURE_NONTRANS_PAYMENT));
		PREPARE DROP_DD_DELETE_FUTURE_CUSTOMER_STMT FROM @DROP_DD_DELETE_FUTURE_CUSTOMER;
		EXECUTE DROP_DD_DELETE_FUTURE_CUSTOMER_STMT;
	END IF;
	IF(DD_TEMP_TBLNAME_UNIT_EXPENSE IS NOT NULL)THEN
		SET @DROP_DD_DELETE_FUTURE_CUSTOMER=(SELECT CONCAT('DROP TABLE IF EXISTS ',DD_TEMP_TBLNAME_UNIT_EXPENSE));
		PREPARE DROP_DD_DELETE_FUTURE_CUSTOMER_STMT FROM @DROP_DD_DELETE_FUTURE_CUSTOMER;
		EXECUTE DROP_DD_DELETE_FUTURE_CUSTOMER_STMT;
	END IF;
	IF(DD_TEMP_TABLENAME_DD_SPLITEDDATE IS NOT NULL)THEN
		SET @DROP_DD_SPLITED_DATE=(SELECT CONCAT('DROP TABLE IF EXISTS ',DD_TEMP_TABLENAME_DD_SPLITEDDATE));
		PREPARE DROP_DD_SPLITED_DATE_STMT FROM @DROP_DD_SPLITED_DATE;
		EXECUTE DROP_DD_SPLITED_DATE_STMT;
	END IF;
	IF(DD_TEMP_TABLENAME_CNT_CUSTOMER IS NOT NULL)THEN
		SET @DROP_DD_COUNT_CUSTOMER=(SELECT CONCAT('DROP TABLE IF EXISTS ',DD_TEMP_TABLENAME_CNT_CUSTOMER));
		PREPARE DROP_DD_COUNT_CUSTOMER_STMT FROM @DROP_DD_COUNT_CUSTOMER;
		EXECUTE DROP_DD_COUNT_CUSTOMER_STMT;
	END IF;
	COMMIT;
END;